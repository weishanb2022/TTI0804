{"version":3,"sources":["../../../widgets/Search/VersionManager.js"],"names":["define","BaseVersionManager","VersionManager","versions","version","upgrader","oldConfig","newConfig","sources","geocoder","oldGeocoder","source","defaultMaxResults","arcgisGeocoder","Object","prototype","toString","call","p","url","singleLineFieldName","name","placeholder","countryCode","sourceCountry","maxResults","maxLocations","push","i","len","geocoders","length","p2","type","upgradeFromGeocoder","allPlaceholder","showInfoWindowOnSelect","addMaxSuggestions","s","maxSuggestions","addZoomScale","zoomScale","_esriLocatorRegExp","lastIndex","enableLocalSearch","test","localSearchMinScale","localSearchDistance","constructor"],"mappings":"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","file":"VersionManager.js","sourcesContent":["///////////////////////////////////////////////////////////////////////////\r\n// Copyright Â© Esri. All Rights Reserved.\r\n//\r\n// Licensed under the Apache License Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//    http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n///////////////////////////////////////////////////////////////////////////\r\ndefine(['jimu/shared/BaseVersionManager'],\r\n  function(BaseVersionManager) {\r\n\r\n    function VersionManager() {\r\n      /*jshint maxlen:150*/\r\n      this.versions = [{\r\n        version: '1.0',\r\n        upgrader: function(oldConfig) {\r\n          return oldConfig;\r\n        }\r\n      }, {\r\n        version: '1.1',\r\n        upgrader: function(oldConfig) {\r\n          return oldConfig;\r\n        }\r\n      }, {\r\n        version: '1.2',\r\n        upgrader: function(oldConfig) {\r\n          return oldConfig;\r\n        }\r\n      }, {\r\n        version: '1.3',\r\n        upgrader: function(oldConfig) {\r\n          var newConfig = {};\r\n          newConfig.sources = [];\r\n          if (!oldConfig.geocoder) {\r\n            return newConfig;\r\n          }\r\n          var oldGeocoder = oldConfig.geocoder;\r\n          var source = null;\r\n          var defaultMaxResults = 6;\r\n          if (oldGeocoder.arcgisGeocoder) {\r\n            source = {};\r\n            if (Object.prototype.toString.call(oldGeocoder.arcgisGeocoder) === \"[object Object]\") {\r\n              for (var p in oldGeocoder.arcgisGeocoder) {\r\n                source[p] = oldGeocoder.arcgisGeocoder[p];\r\n              }\r\n              source.url = source.url ||\r\n                \"https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer\";\r\n              source.singleLineFieldName = source.singleLineFieldName || \"SingleLine\";\r\n              source.name = source.name || \"Esri World Geocoder\";\r\n            } else if (typeof oldGeocoder.arcgisGeocoder === \"boolean\") {\r\n              source.url = \"https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer\";\r\n              source.name = \"Esri World Geocoder\";\r\n              source.singleLineFieldName = \"SingleLine\";\r\n              source.placeholder = \"Esri World Geocoder\";\r\n            }\r\n            source.countryCode = source.sourceCountry || source.countryCode || \"\";\r\n            source.maxResults = oldGeocoder.maxLocations || defaultMaxResults;\r\n            newConfig.sources.push(source);\r\n          }\r\n\r\n          for (var i = 0, len = oldGeocoder.geocoders.length; i < len; i++) {\r\n            source = {};\r\n            var geocoder = oldGeocoder.geocoders[i];\r\n            for (var p2 in geocoder) {\r\n              source[p2] = geocoder[p2];\r\n            }\r\n            source.countryCode = source.sourceCountry || source.countryCode || \"\";\r\n            source.maxResults = oldGeocoder.maxLocations || defaultMaxResults;\r\n            source.type = source.type || \"locator\";\r\n            newConfig.sources.push(source);\r\n          }\r\n\r\n          newConfig.upgradeFromGeocoder = true;\r\n          return newConfig;\r\n        }\r\n      }, {\r\n        version: \"1.4\",\r\n        upgrader: function(oldConfig) {\r\n          oldConfig.allPlaceholder = \"\";\r\n          oldConfig.showInfoWindowOnSelect = true;\r\n\r\n          return oldConfig;\r\n        }\r\n      }, {\r\n        version: \"2.0beta\",\r\n        upgrader: function(oldConfig) {\r\n          function addMaxSuggestions(sources) {\r\n            for (var i = 0, len = sources.length; i < len; i++) {\r\n              var s = sources[i];\r\n              s.maxSuggestions = s.maxSuggestions || 6;\r\n            }\r\n          }\r\n\r\n          function addZoomScale(sources) {\r\n            for (var i = 0, len = sources.length; i < len; i++) {\r\n              var s = sources[i];\r\n              s.zoomScale = s.zoomScale || 50000;\r\n            }\r\n          }\r\n\r\n          addMaxSuggestions(oldConfig.sources);\r\n          addZoomScale(oldConfig.sources);\r\n\r\n          return oldConfig;\r\n        }\r\n      }, {\r\n        version: '2.0',\r\n        upgrader: function(oldConfig) {\r\n          return oldConfig;\r\n        }\r\n      }, {\r\n        version: '2.0.1',\r\n        upgrader: function(oldConfig) {\r\n          return oldConfig;\r\n        }\r\n      }, {\r\n        version: '2.1',\r\n        upgrader: function(oldConfig) {\r\n          return oldConfig;\r\n        }\r\n      }, {\r\n        version: '2.2',\r\n        upgrader: function(oldConfig) {\r\n          var newConfig = oldConfig;\r\n          var _esriLocatorRegExp = /http(s)?:\\/\\/geocode(.){0,3}\\.arcgis.com\\/arcgis\\/rest\\/services\\/World\\/GeocodeServer/g;\r\n          for (var i = 0, len = newConfig.sources.length; i < len; i++) {\r\n            var source = newConfig.sources[i];\r\n            if (source.type === 'locator') {\r\n              _esriLocatorRegExp.lastIndex = 0;\r\n              source.enableLocalSearch = _esriLocatorRegExp.test(source.url);\r\n              source.localSearchMinScale = 300000;\r\n              source.localSearchDistance = 50000;\r\n            }\r\n          }\r\n\r\n          return newConfig;\r\n        }\r\n      }, {\r\n        version: '2.3',\r\n        upgrader: function(oldConfig){\r\n          return oldConfig;\r\n        }\r\n      }, {\r\n        version: '2.4',\r\n        upgrader: function(oldConfig){\r\n          return oldConfig;\r\n        }\r\n      }, {\r\n        version: '2.5',\r\n        upgrader: function(oldConfig){\r\n          return oldConfig;\r\n        }\r\n      }, {\r\n        version: '2.6',\r\n        upgrader: function(oldConfig){\r\n          return oldConfig;\r\n        }\r\n      }, {\r\n        version: '2.7',\r\n        upgrader: function(oldConfig){\r\n          return oldConfig;\r\n        }\r\n      }, {\r\n        version: '2.8',\r\n        upgrader: function(oldConfig){\r\n          return oldConfig;\r\n        }\r\n      }, {\r\n        version: '2.9',\r\n        upgrader: function(oldConfig){\r\n          var newConfig = oldConfig;\r\n          for(var i = 0; i < newConfig.sources.length; i++) {\r\n            var source = newConfig.sources[i];\r\n            if(source && source.zoomScale && source.zoomScale === 50000) {\r\n              source.zoomScale = null;\r\n            }\r\n          }\r\n          return newConfig;\r\n        }\r\n      }];\r\n    }\r\n\r\n    VersionManager.prototype = new BaseVersionManager();\r\n    VersionManager.prototype.constructor = VersionManager;\r\n    return VersionManager;\r\n  });\r\n"]}