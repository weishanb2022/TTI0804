{"version":3,"sources":["../../../../widgets/Search/setting/LocatorSourceSetting.js"],"names":["define","declare","lang","html","on","Evented","Deferred","_WidgetBase","_TemplatedMixin","_WidgetsInTemplateMixin","portalUrlUtils","Message","_GeocodeServiceChooserContent","Popup","LoadingShelter","esriRequest","esriLang","utils","jimuUtils","template","CheckBox","baseClass","tr","nls","config","singleLineFieldName","templateString","_suggestible","_locatorDefinition","_esriLocatorRegExp","serviceChooserContent","geocoderPopup","_clickSet","_defaultZoomScale","postCreate","inherited","arguments","zoomScale","set","window","jimuNls","common","defaults","exampleHint","locatorExample","searchInCurrentMapExtent","checked","label","enableLocalSearch","_processlocalSearchTable","own","hitch","getValue","setStyle","domNode","_setMessageNodeContent","panToRadio","_onRadioClicke","zoomToRadio","setConfig","setRelatedTr","getRelatedTr","setDefinition","definition","getDefinition","Object","prototype","toString","call","url","shelter","show","_getDefinitionFromRemote","then","response","type","_setSourceItems","_disableSourceItems","substitute","clone","invalidUrlTip","hide","isValidConfig","getConfig","name","showValidationTip","_showValidationErrorTip","locatorUrl","locatorName","geocode","get","stripHTML","placeholder","countryCode","panToScale","maxSuggestions","maxResults","localSearchMinScale","localSearchDistance","radiusUnit","_onLocatorNameBlur","_onPlaceholderBlur","_onCountryCodeBlur","_enableSourceItems","_controlZoomScaleTextBox","_processCountryCodeRow","_processLocalSearchRadiusUnit","setValue","capabilities","indexOf","_showSuggestibleTips","_hideSuggestibleTips","_isEsriLocator","lastIndex","test","resultDef","resolve","singleLineAddressField","alias","required","length","localizedNames","recognizedNames","def","content","f","handleAs","callbackParamName","err","console","error","_getRequestUrl","promise","empty","messageNode","nodeType","toDom","place","addClass","removeClass","protocol","location","setHttpProtocol","setHttpsProtocol","_onSetLocatorUrlClick","_openServiceChooser","_openLocatorChooser","hidden","titleLabel","setGeocoderURL","autoHeight","container","jimuConfig","layoutId","width","placeAt","_onSelectLocatorUrlOk","evt","getGeocoderName","emit","close","locatorWarning","_onSelectLocatorUrlCancel","options","units","meters","value","kilometers","nauticalMiles","miles","yards","feet","enable","minScaleNode","radiusNode","radiusBox","getMarginBox","radiusHintNode","defaultPB","parentNode","h","countryCodeRow","tipsNode","_dijit","validate","focusNode","_disabled","focus","setTimeout","blur"],"mappings":"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","file":"LocatorSourceSetting.js","sourcesContent":["///////////////////////////////////////////////////////////////////////////\r\n// Copyright © Esri. All Rights Reserved.\r\n//\r\n// Licensed under the Apache License Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//    http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n///////////////////////////////////////////////////////////////////////////\r\ndefine(\r\n  [\"dojo/_base/declare\",\r\n    \"dojo/_base/lang\",\r\n    \"dojo/_base/html\",\r\n    \"dojo/on\",\r\n    \"dojo/Evented\",\r\n    \"dojo/Deferred\",\r\n    \"dijit/_WidgetBase\",\r\n    \"dijit/_TemplatedMixin\",\r\n    \"dijit/_WidgetsInTemplateMixin\",\r\n    \"jimu/portalUrlUtils\",\r\n    \"jimu/dijit/Message\",\r\n    \"jimu/dijit/_GeocodeServiceChooserContent\",\r\n    \"jimu/dijit/Popup\",\r\n    \"jimu/dijit/LoadingShelter\",\r\n    \"esri/request\",\r\n    \"esri/lang\",\r\n    \"../utils\",\r\n    \"jimu/utils\",\r\n    \"dojo/text!./LocatorSourceSetting.html\",\r\n    \"jimu/dijit/CheckBox\",\r\n    \"dijit/form/ValidationTextBox\",\r\n    \"dijit/form/RadioButton\",\r\n    \"dijit/form/NumberTextBox\"\r\n  ],\r\n  function(\r\n    declare,\r\n    lang,\r\n    html,\r\n    on,\r\n    Evented,\r\n    Deferred,\r\n    _WidgetBase,\r\n    _TemplatedMixin,\r\n    _WidgetsInTemplateMixin,\r\n    portalUrlUtils,\r\n    Message,\r\n    _GeocodeServiceChooserContent,\r\n    Popup,\r\n    LoadingShelter,\r\n    esriRequest,\r\n    esriLang,\r\n    utils,\r\n    jimuUtils,\r\n    template,\r\n    CheckBox) {\r\n    /*jshint maxlen:150*/\r\n    return declare([\r\n      _WidgetBase, _TemplatedMixin, _WidgetsInTemplateMixin, Evented\r\n    ], {\r\n      baseClass: \"jimu-widget-search-locator-source-setting\",\r\n      tr: null,\r\n      nls: null,\r\n      config: null,\r\n      singleLineFieldName: null,\r\n      templateString: template,\r\n\r\n      _suggestible: false,\r\n      _locatorDefinition: null,\r\n      _esriLocatorRegExp: /http(s)?:\\/\\/geocode(.){0,3}\\.arcgis.com\\/arcgis\\/rest\\/services\\/World\\/GeocodeServer/g,\r\n      serviceChooserContent: null,\r\n      geocoderPopup: null,\r\n\r\n      _clickSet: false,\r\n      _defaultZoomScale: null,\r\n\r\n      postCreate: function() {\r\n        this.inherited(arguments);\r\n        this.zoomScale.set('placeHolder', window.jimuNls.common.defaults);\r\n        this.exampleHint = this.nls.locatorExample +\r\n          \": http://&lt;myServerName&gt;/arcgis/rest/services/World/GeocodeServer\";\r\n\r\n        this.searchInCurrentMapExtent = new CheckBox({\r\n          checked: false,\r\n          label: this.nls.searchInCurrentMapExtent\r\n        }, this.searchInCurrentMapExtent);\r\n\r\n        this.enableLocalSearch = new CheckBox({\r\n          checked: false,\r\n          label: this.nls.enableLocalSearch\r\n        }, this.enableLocalSearch);\r\n        this._processlocalSearchTable(false);\r\n        this.own(on(this.enableLocalSearch, 'change', lang.hitch(this, function() {\r\n          this._processlocalSearchTable(this.enableLocalSearch.getValue());\r\n        })));\r\n        html.setStyle(this.enableLocalSearch.domNode, 'display', 'none');\r\n\r\n        this._setMessageNodeContent(this.exampleHint);\r\n        this.own(on(this.panToRadio, 'click', lang.hitch(this, this._onRadioClicke)));\r\n        this.own(on(this.zoomToRadio, 'click', lang.hitch(this, this._onRadioClicke)));\r\n\r\n        this.config = this.config ? this.config : {};\r\n        this.setConfig(this.config);\r\n      },\r\n\r\n      setRelatedTr: function(tr) {\r\n        this.tr = tr;\r\n      },\r\n\r\n      getRelatedTr: function() {\r\n        return this.tr;\r\n      },\r\n\r\n      setDefinition: function(definition) {\r\n        this._locatorDefinition = definition || {};\r\n      },\r\n\r\n      getDefinition: function() {\r\n        return this._locatorDefinition;\r\n      },\r\n\r\n      setConfig: function(config) {\r\n        if (Object.prototype.toString.call(config) !== \"[object Object]\") {\r\n          return;\r\n        }\r\n\r\n        var url = config.url;\r\n        if (!url) {\r\n          // set default zoomToRadio if there is no url.\r\n          //html.setAttr(this.zoomToRadio, 'checked', '');\r\n          this.zoomToRadio.set('checked', true);\r\n          return;\r\n        }\r\n        this.config = config;\r\n\r\n        this.shelter.show();\r\n        if (this._locatorDefinition.url !== url) {\r\n          this._getDefinitionFromRemote(url).then(lang.hitch(this, function(response) {\r\n            if (url && (response && response.type !== 'error')) {\r\n              this._locatorDefinition = response;\r\n              this._locatorDefinition.url = url;\r\n              this._setSourceItems();\r\n\r\n              this._setMessageNodeContent(this.exampleHint);\r\n            } else if (url && (response && response.type === 'error')) {\r\n              this._setSourceItems();\r\n              this._disableSourceItems();\r\n\r\n              this._setMessageNodeContent(esriLang.substitute({\r\n                'URL': response.url\r\n              }, lang.clone(this.nls.invalidUrlTip)), true);\r\n            }\r\n            this.shelter.hide();\r\n          }));\r\n        } else {\r\n          this._setSourceItems();\r\n          this._setMessageNodeContent(this.exampleHint);\r\n          this.shelter.hide();\r\n        }\r\n      },\r\n\r\n      isValidConfig: function() {\r\n        var config = this.getConfig();\r\n        if (config.url && config.name && config.singleLineFieldName) {\r\n          return true;\r\n        } else {\r\n          return false;\r\n        }\r\n      },\r\n\r\n      showValidationTip: function() {\r\n        this._showValidationErrorTip(this.locatorUrl);\r\n        this._showValidationErrorTip(this.locatorName);\r\n      },\r\n\r\n      getConfig: function() {\r\n        var geocode = {\r\n          url: this.locatorUrl.get('value'),\r\n          name: jimuUtils.stripHTML(this.locatorName.get('value')),\r\n          singleLineFieldName: this.singleLineFieldName,\r\n          placeholder: jimuUtils.stripHTML(this.placeholder.get('value')),\r\n          countryCode: jimuUtils.stripHTML(this.countryCode.get('value')),\r\n          panToScale: this.panToRadio.get('checked') ? true : false,\r\n          zoomScale: this.zoomScale.get('value') || this._defaultZoomScale,\r\n          maxSuggestions: this.maxSuggestions.get('value'),\r\n          maxResults: this.maxResults.get('value') || 6,\r\n          searchInCurrentMapExtent: this.searchInCurrentMapExtent.checked,\r\n          enableLocalSearch: this.enableLocalSearch.getValue(),\r\n          localSearchMinScale: this.localSearchMinScale.get('value'),\r\n          localSearchDistance: this.localSearchDistance.get('value'),\r\n          radiusUnit: this.radiusUnit.get('value'),\r\n          type: \"locator\"\r\n        };\r\n        return geocode;\r\n      },\r\n\r\n      _onLocatorNameBlur: function() {\r\n        this.locatorName.set('value', jimuUtils.stripHTML(this.locatorName.get('value')));\r\n      },\r\n\r\n      _onPlaceholderBlur: function() {\r\n        this.placeholder.set('value', jimuUtils.stripHTML(this.placeholder.get('value')));\r\n      },\r\n\r\n      _onCountryCodeBlur: function() {\r\n        this.countryCode.set('value', jimuUtils.stripHTML(this.countryCode.get('value')));\r\n      },\r\n\r\n      _disableSourceItems: function() {\r\n        this.locatorName.set('disabled', true);\r\n        this.placeholder.set('disabled', true);\r\n        this.countryCode.set('disabled', true);\r\n        this.maxSuggestions.set('disabled', true);\r\n        this.maxResults.set('disabled', true);\r\n        this.zoomScale.set('disabled', true);\r\n      },\r\n\r\n      _enableSourceItems: function() {\r\n        this.locatorName.set('disabled', false);\r\n        this.placeholder.set('disabled', false);\r\n        this.countryCode.set('disabled', false);\r\n        this.maxSuggestions.set('disabled', false);\r\n        this.maxResults.set('disabled', false);\r\n        this._controlZoomScaleTextBox();\r\n      },\r\n\r\n      _setSourceItems: function() {\r\n        var config = this.config;\r\n        if (config.url) {\r\n          // this.validService = true;\r\n          this.locatorUrl.set('value', config.url);\r\n          this._processCountryCodeRow(config.url);\r\n        }\r\n        if (config.name) {\r\n          this.locatorName.set('value', jimuUtils.stripHTML(config.name));\r\n        }\r\n        if (config.singleLineFieldName) {\r\n          this.singleLineFieldName = config.singleLineFieldName;\r\n        }\r\n        if (config.placeholder) {\r\n          this.placeholder.set('value', jimuUtils.stripHTML(config.placeholder));\r\n        }\r\n        if (config.countryCode) {\r\n          this.countryCode.set('value', jimuUtils.stripHTML(config.countryCode));\r\n        }\r\n\r\n        this._processLocalSearchRadiusUnit();\r\n        if ('capabilities' in this._locatorDefinition) {\r\n          html.setStyle(this.enableLocalSearch.domNode, 'display', '');\r\n          this._processlocalSearchTable(config.enableLocalSearch);\r\n          this.enableLocalSearch.setValue(config.enableLocalSearch);\r\n          if (config.localSearchMinScale && config.enableLocalSearch) {\r\n            this.localSearchMinScale.set('value', config.localSearchMinScale);\r\n          }\r\n          if (config.localSearchDistance && config.enableLocalSearch) {\r\n            this.localSearchDistance.set('value', config.localSearchDistance);\r\n          }\r\n          this.radiusUnit.set('value', config.radiusUnit || 'meter');\r\n        } else {\r\n          this.enableLocalSearch.setValue(false);\r\n          html.setStyle(this.enableLocalSearch.domNode, 'display', 'none');\r\n        }\r\n\r\n        this._suggestible = this._locatorDefinition && this._locatorDefinition.capabilities &&\r\n          this._locatorDefinition.capabilities.indexOf(\"Suggest\") > -1;\r\n        if (!this._suggestible) {\r\n          this._showSuggestibleTips();\r\n        } else {\r\n          this._hideSuggestibleTips();\r\n        }\r\n\r\n        this.searchInCurrentMapExtent.setValue(!!config.searchInCurrentMapExtent);\r\n\r\n        //html.removeAttr(this.zoomToRadio, 'checked');\r\n        this.zoomToRadio.set('checked', false);\r\n        if(this.config.panToScale) {\r\n          //html.setAttr(this.panToRadio, 'checked', '');\r\n          this.panToRadio.set('checked', true);\r\n        } else {\r\n          //html.setAttr(this.zoomToRadio, 'checked', '');\r\n          this.zoomToRadio.set('checked', true);\r\n        }\r\n\r\n        this.zoomScale.set('value', config.zoomScale || this._defaultZoomScale);\r\n\r\n        this.maxSuggestions.set('value', config.maxSuggestions);\r\n\r\n        this.maxResults.set('value', config.maxResults || 6);\r\n\r\n        this._enableSourceItems();\r\n      },\r\n\r\n      _isEsriLocator: function(url) {\r\n        this._esriLocatorRegExp.lastIndex = 0;\r\n        return this._esriLocatorRegExp.test(url);\r\n      },\r\n\r\n      _getDefinitionFromRemote: function(url) {\r\n        var resultDef = new Deferred();\r\n        if (this._isEsriLocator(url)) {\r\n          // optimize time\r\n          resultDef.resolve({\r\n            singleLineAddressField: {\r\n              name: \"SingleLine\",\r\n              type: \"esriFieldTypeString\",\r\n              alias: \"Single Line Input\",\r\n              required: false,\r\n              length: 200,\r\n              localizedNames: {},\r\n              recognizedNames: {}\r\n            },\r\n            capabilities: \"Geocode,ReverseGeocode,Suggest\"\r\n          });\r\n        } else {\r\n          var def = esriRequest({\r\n            url: url,\r\n            content: {\r\n              f: 'json'\r\n            },\r\n            handleAs: 'json',\r\n            callbackParamName: 'callback'\r\n          });\r\n          this.own(def);\r\n          def.then(lang.hitch(this, function(response) {\r\n            resultDef.resolve(response);\r\n          }), lang.hitch(this, function(err) {\r\n            console.error(err);\r\n            resultDef.resolve({\r\n              type: 'error',\r\n              url: this._getRequestUrl(url)\r\n            });\r\n          }));\r\n        }\r\n\r\n        return resultDef.promise;\r\n      },\r\n\r\n      _setMessageNodeContent: function(content, err) {\r\n        html.empty(this.messageNode);\r\n        if (!content.nodeType) {\r\n          content = html.toDom(content);\r\n        }\r\n        html.place(content, this.messageNode);\r\n        if (err) {\r\n          html.addClass(this.messageNode, 'error-message');\r\n        } else {\r\n          html.removeClass(this.messageNode, 'error-message');\r\n        }\r\n      },\r\n\r\n      _getRequestUrl: function(url) {\r\n        var protocol = window.location.protocol;\r\n        if (protocol === 'http:') {\r\n          return portalUrlUtils.setHttpProtocol(url);\r\n        } else if (protocol === 'https:'){\r\n          return portalUrlUtils.setHttpsProtocol(url);\r\n        } else {\r\n          return url;\r\n        }\r\n      },\r\n\r\n      _onSetLocatorUrlClick: function() {\r\n        this._clickSet = true;\r\n        this._openServiceChooser();\r\n      },\r\n\r\n      _openLocatorChooser: function() {\r\n        this._clickSet = false;\r\n        this._openServiceChooser();\r\n      },\r\n\r\n      _openServiceChooser: function() {\r\n        this.serviceChooserContent = new _GeocodeServiceChooserContent({\r\n          url: this.locatorUrl.get('value') || \"\"\r\n        });\r\n        this.shelter = new LoadingShelter({\r\n          hidden: true\r\n        });\r\n\r\n        this.geocoderPopup = new Popup({\r\n          titleLabel: this.nls.setGeocoderURL,\r\n          autoHeight: true,\r\n          content: this.serviceChooserContent.domNode,\r\n          container: window.jimuConfig.layoutId,\r\n          width: 640\r\n        });\r\n        this.shelter.placeAt(this.geocoderPopup.domNode);\r\n        html.setStyle(this.serviceChooserContent.domNode, 'width', '580px');\r\n        html.addClass(\r\n          this.serviceChooserContent.domNode,\r\n          'override-geocode-service-chooser-content'\r\n        );\r\n\r\n        this.serviceChooserContent.own(\r\n          on(this.serviceChooserContent, 'validate-click', lang.hitch(this, function() {\r\n            html.removeClass(\r\n              this.serviceChooserContent.domNode,\r\n              'override-geocode-service-chooser-content'\r\n            );\r\n          }))\r\n        );\r\n        this.serviceChooserContent.own(\r\n          on(this.serviceChooserContent, 'ok', lang.hitch(this, '_onSelectLocatorUrlOk'))\r\n        );\r\n        this.serviceChooserContent.own(\r\n          on(this.serviceChooserContent, 'cancel', lang.hitch(this, '_onSelectLocatorUrlCancel'))\r\n        );\r\n      },\r\n\r\n      _onSelectLocatorUrlOk: function(evt) {\r\n        if (!(evt && evt[0] && evt[0].url && this.domNode)) {\r\n          return;\r\n        }\r\n        this.shelter.show();\r\n        esriRequest({\r\n          url: evt[0].url,\r\n          content: {\r\n            f: 'json'\r\n          },\r\n          handleAs: 'json',\r\n          callbackParamName: 'callback'\r\n        }).then(lang.hitch(this, function(response) {\r\n          this.shelter.hide();\r\n          if (response &&\r\n            response.singleLineAddressField &&\r\n            response.singleLineAddressField.name) {\r\n            this._enableSourceItems();\r\n            this.locatorUrl.set('value', evt[0].url);\r\n            if(!this.locatorName.get('value')){\r\n              this.locatorName.set('value', utils.getGeocoderName(evt[0].url));\r\n            }\r\n            if ('capabilities' in response) {\r\n              html.setStyle(this.enableLocalSearch.domNode, 'display', '');\r\n              if (this._isEsriLocator(evt[0].url)) {\r\n                this.enableLocalSearch.setValue(true);\r\n              } else {\r\n                this.enableLocalSearch.setValue(false);\r\n              }\r\n            } else {\r\n              this.enableLocalSearch.setValue(false);\r\n              html.setStyle(this.enableLocalSearch.domNode, 'display', 'none');\r\n            }\r\n\r\n            this.singleLineFieldName = response.singleLineAddressField.name;\r\n\r\n            this._processCountryCodeRow(evt[0].url);\r\n\r\n            this._locatorDefinition = response;\r\n            this._locatorDefinition.url = evt[0].url;\r\n            this._suggestible = response.capabilities &&\r\n              this._locatorDefinition.capabilities.indexOf(\"Suggest\") > -1;\r\n            if (!this._suggestible) {\r\n              this._showSuggestibleTips();\r\n            } else {\r\n              this._hideSuggestibleTips();\r\n            }\r\n\r\n            if (this._clickSet) {\r\n              this.emit('reselect-locator-url-ok', this.getConfig());\r\n            } else {\r\n              this.emit('select-locator-url-ok', this.getConfig());\r\n            }\r\n            if (this.geocoderPopup) {\r\n              this.geocoderPopup.close();\r\n              this.geocoderPopup = null;\r\n            }\r\n\r\n            this._setMessageNodeContent(this.exampleHint);\r\n          } else {\r\n            new Message({\r\n              'message': this.nls.locatorWarning\r\n            });\r\n          }\r\n        }), lang.hitch(this, function(err) {\r\n          console.error(err);\r\n          this.shelter.hide();\r\n          new Message({\r\n            'message': esriLang.substitute({\r\n                'URL': this._getRequestUrl(evt[0].url)\r\n              }, lang.clone(this.nls.invalidUrlTip))\r\n          });\r\n        }));\r\n      },\r\n\r\n      _onSelectLocatorUrlCancel: function() {\r\n        if (this.geocoderPopup) {\r\n          this.geocoderPopup.close();\r\n          this.geocoderPopup = null;\r\n\r\n          this.emit('select-locator-url-cancel');\r\n        }\r\n      },\r\n\r\n      _processLocalSearchRadiusUnit: function() {\r\n        var options = [{\r\n          label: window.jimuNls.units.meters,\r\n          value: \"meter\"\r\n        }, {\r\n          label: window.jimuNls.units.kilometers,\r\n          value: \"kilometer\"\r\n        }, {\r\n          label: window.jimuNls.units.nauticalMiles,\r\n          value: \"nauticalMile\"\r\n        }, {\r\n          label: window.jimuNls.units.miles,\r\n          value: \"mile\"\r\n        }, {\r\n          label: window.jimuNls.units.yards,\r\n          value: \"yard\"\r\n        }, {\r\n          label: window.jimuNls.units.feet,\r\n          value: \"foot\"\r\n        }/*, {\r\n          label: window.jimuNls.units.inches,\r\n          value: \"inch\"\r\n        }*/];\r\n\r\n        this.radiusUnit.set('options', options);\r\n      },\r\n\r\n      _processlocalSearchTable: function(enable) {\r\n        if (enable) {\r\n          html.removeClass(this.minScaleNode, 'hide-local-search-table');\r\n          html.removeClass(this.radiusNode, 'hide-local-search-table');\r\n\r\n          var radiusBox = html.getMarginBox(this.radiusHintNode);\r\n          var defaultPB = 45;\r\n          html.setStyle(\r\n            this.radiusHintNode.parentNode,\r\n            'paddingBottom',\r\n            (radiusBox.h > defaultPB ? radiusBox.h + 10 : defaultPB) + 'px'\r\n          );\r\n        } else {\r\n          html.addClass(this.minScaleNode, 'hide-local-search-table');\r\n          html.addClass(this.radiusNode, 'hide-local-search-table');\r\n        }\r\n      },\r\n\r\n      _processCountryCodeRow: function(url) {\r\n        if (this._isEsriLocator(url)) {\r\n          this.countryCode.set('value', \"\");\r\n          html.removeClass(this.countryCodeRow, 'hide-country-code-row');\r\n        } else {\r\n          html.addClass(this.countryCodeRow, 'hide-country-code-row');\r\n        }\r\n      },\r\n\r\n      _showSuggestibleTips: function() {\r\n        html.addClass(this.tipsNode, 'source-tips-show');\r\n        html.setStyle(this.maxSuggestions.domNode, 'display', 'none');\r\n      },\r\n\r\n      _hideSuggestibleTips: function() {\r\n        html.removeClass(this.tipsNode, 'source-tips-show');\r\n        html.setStyle(this.maxSuggestions.domNode, 'display', 'block');\r\n      },\r\n\r\n      _showValidationErrorTip: function(_dijit) {\r\n        if (!_dijit.validate() && _dijit.domNode) {\r\n          if (_dijit.focusNode) {\r\n            var _disabled = _dijit.get('disabled');\r\n            if (_disabled) {\r\n              _dijit.set('disabled', false);\r\n            }\r\n            _dijit.focusNode.focus();\r\n            setTimeout(lang.hitch(this, function() {\r\n              _dijit.focusNode.blur();\r\n              if (_disabled) {\r\n                _dijit.set('disabled', true);\r\n              }\r\n              _dijit = null;\r\n            }), 100);\r\n          }\r\n        }\r\n      },\r\n\r\n      _controlZoomScaleTextBox: function() {\r\n        if(this.panToRadio.get('checked')){\r\n          this.zoomScale.set(\"disabled\", true);\r\n        } else if(this.zoomToRadio.get('checked')){\r\n          this.zoomScale.set(\"disabled\", false);\r\n        }\r\n      },\r\n\r\n      _onRadioClicke: function() {\r\n        this._controlZoomScaleTextBox();\r\n      }\r\n    });\r\n  });\r\n"]}