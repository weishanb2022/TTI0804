{"version":3,"sources":["../../../widgets/Splash/Widget.js"],"names":["define","declare","lang","html","on","keys","query","cookie","_WidgetsInTemplateMixin","BaseWidget","topic","CheckBox","utils","esriLang","LoadingShelter","Deferred","EditorXssFilter","EditorPreviewLinkMessager","clazz","baseClass","_hasContent","_requireConfirm","_isClosed","postCreate","inherited","arguments","isFirstFoucs","setAttr","domNode","nls","_widgetLabel","shelter","hidden","placeAt","startup","config","splash","splashContent","getInstance","sanitize","requireConfirm","_showOption","showOption","_confirmEverytime","confirmEverytime","customContentNode","innerHTML","setStyle","confirmCheck","addClass","okNode","hint","confirm","text","notShowAgain","label","stripHTML","checked","own","hitch","onCheckBoxClick","onOpen","isInConfigOrPreviewWindow","isFirstKey","_getCookieKey","isfirst","isDefined","toString","close","window","queryObject","disableSplashFocus","focusFirstFocusNode","_eventShow","show","_normalizeDomNodePosition","_setConfig","evt","hasClass","target","keyCode","ESCAPE","focusOnFirstSkipLink","splashDesktop","TAB","preventDefault","ENTER","shiftKey","focusableNodes","getFocusNodesInDom","initFirstFocusNode","initLastFocusNode","_onlyFocus","scrollTop","blur","setTimeout","focus","setWABLogoDefaultAlt","_setOkNodeAriaLabel","isDisable","getValue","attr","_setWidthForOldVersion","then","_setSizeFromConfig","button","color","invertColor","transparency","ok","background","mode","image","bg","repeat","processUrlInWidgetConfig","folderUrl","type","splashContainerNode","splashContainerBackground","dom","contentVertical","resize","_resizeContentImg","removeClass","envelopeNode","editorPreviewLinkMessager","isInBuilder","error","isHasContent","filter","hide","setPosition","position","place","jimuConfig","layoutId","started","_changeStatus","customBox","getContentBox","empty","toDom","nodeType","contentImgs","length","style","maxWidth","w","maxHeight","h","appInfo","isRunInMobile","_resizeCustomContent","_getNodeStylePx","node","prop","parseInt","getStyle","containerContent","customContentScrollheight","scrollHeight","footerBox","getMarginBox","footerNode","contentMarginButtom","footerBottom","contentSpace","isNeedLimitCustomContentHeight","_moveContentToMiddle","context","contentMarginTop","middleLine","uponTheMiddleline","abs","Math","encodeURIComponent","getAppIdFromUrl","onOkClick","expires","path","onOkKeydown","SPACE","_eventHide","widgetManager","closeWidget","size","percent","wh","_setWidthInCurrentScreen","_setHeightInCurrentScreen","screenWidth","innerWidth","screenHeight","innerHeight","def","isOldVersion","getEditorContentHeight","resolve","publish"],"mappings":"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","file":"Widget.js","sourcesContent":["///////////////////////////////////////////////////////////////////////////\r\n// Copyright Â© Esri. All Rights Reserved.\r\n//\r\n// Licensed under the Apache License Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//    http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n///////////////////////////////////////////////////////////////////////////\r\n\r\ndefine(['dojo/_base/declare',\r\n    'dojo/_base/lang',\r\n    'dojo/_base/html',\r\n    'dojo/on',\r\n    'dojo/keys',\r\n    'dojo/query',\r\n    'dojo/cookie',\r\n    'dijit/_WidgetsInTemplateMixin',\r\n    'jimu/BaseWidget',\r\n    'dojo/topic',\r\n    'jimu/dijit/CheckBox',\r\n    'jimu/utils',\r\n    'esri/lang',\r\n    'jimu/dijit/LoadingShelter',\r\n    'dojo/Deferred',\r\n    'jimu/dijit/EditorXssFilter',\r\n    'jimu/dijit/EditorPreviewLinkMessager'\r\n  ],\r\n  function(declare, lang, html, on, keys, query, cookie, _WidgetsInTemplateMixin, BaseWidget, topic,\r\n           CheckBox, utils, esriLang, LoadingShelter, Deferred, EditorXssFilter, EditorPreviewLinkMessager) {\r\n    var clazz = declare([BaseWidget, _WidgetsInTemplateMixin], {\r\n      baseClass: 'jimu-widget-splash',\r\n      _hasContent: null,\r\n      _requireConfirm: null,\r\n      _isClosed: false,\r\n\r\n      postCreate: function() {\r\n        this.inherited(arguments);\r\n        this.isFirstFoucs = true;\r\n        html.setAttr(this.domNode, 'aria-label', this.nls._widgetLabel);\r\n\r\n        //LoadingShelter\r\n        this.shelter = new LoadingShelter({\r\n          hidden: true\r\n        });\r\n        this.shelter.placeAt(this.domNode);\r\n        this.shelter.startup();\r\n\r\n        //xss filter\r\n        this.config.splash.splashContent = EditorXssFilter.getInstance().sanitize(this.config.splash.splashContent);\r\n\r\n        this._hasContent = this.config.splash && this.config.splash.splashContent;\r\n        this._requireConfirm = this.config.splash && this.config.splash.requireConfirm;\r\n        this._showOption = this.config.splash && this.config.splash.showOption;\r\n        this._confirmEverytime = this.config.splash && this.config.splash.confirmEverytime;\r\n\r\n        if (this._hasContent) {\r\n          this.customContentNode.innerHTML = this.config.splash.splashContent;\r\n        }\r\n\r\n        if (!this._requireConfirm && !this._showOption) {\r\n          html.setStyle(this.confirmCheck, 'display', 'none');\r\n          html.addClass(this.okNode, 'enable-btn');\r\n        } else {\r\n          var hint = \"\";\r\n          if (this._requireConfirm) {\r\n            hint = this.config.splash.confirm.text;\r\n            html.addClass(this.okNode, 'disable-btn');\r\n          } else {\r\n            hint = this.nls.notShowAgain;\r\n            html.addClass(this.okNode, 'enable-btn');\r\n          }\r\n          this.confirmCheck = new CheckBox({\r\n            label: utils.stripHTML(hint),\r\n            checked: false\r\n          }, this.confirmCheck);\r\n          this.own(on(this.confirmCheck, 'change', lang.hitch(this, this.onCheckBoxClick)));\r\n          this.confirmCheck.startup();\r\n        }\r\n      },\r\n\r\n      onOpen: function() {\r\n        if (!utils.isInConfigOrPreviewWindow()) {\r\n          var isFirstKey = this._getCookieKey();\r\n          var isfirst = cookie(isFirstKey);\r\n          if (esriLang.isDefined(isfirst) && isfirst.toString() === 'false') {\r\n            this.close();\r\n          }\r\n        }\r\n        // Just focus on first node (content DOM).\r\n        // For case: Embeded + Splash widget, not grab focus by default when disableSplashFocus = true.\r\n        if (window.queryObject.disableSplashFocus !== 'true') {\r\n          utils.focusFirstFocusNode(this.domNode);\r\n        }\r\n\r\n        this._eventShow();\r\n      },\r\n\r\n      startup: function() {\r\n        this.inherited(arguments);\r\n        this.shelter.show();\r\n        this._normalizeDomNodePosition();\r\n\r\n        this._setConfig();\r\n\r\n        this.own(on(this.domNode, 'keydown', lang.hitch(this, function(evt){\r\n          if(html.hasClass(evt.target, this.baseClass) && evt.keyCode === keys.ESCAPE){\r\n            if(!this._requireConfirm){\r\n              this.close();\r\n              utils.focusOnFirstSkipLink();\r\n            }\r\n          }\r\n        })));\r\n\r\n        this.own(on(this.splashDesktop, 'keydown', lang.hitch(this, function(evt){\r\n          if(html.hasClass(evt.target, 'jimu-widget-splash-desktop')){\r\n            if(evt.keyCode === keys.TAB){\r\n              evt.preventDefault();\r\n            }\r\n            //allow user to use tab-key to focus first node from widgetDom on this spacial widget.\r\n            if(evt.keyCode === keys.ENTER || (!evt.shiftKey && evt.keyCode === keys.TAB)){\r\n              utils.focusFirstFocusNode(this.domNode);\r\n            }\r\n          }\r\n        })));\r\n\r\n        var focusableNodes = utils.getFocusNodesInDom(this.domNode);\r\n        utils.initFirstFocusNode(this.domNode, focusableNodes[0]);\r\n        utils.initLastFocusNode(this.domNode, this.okNode);\r\n\r\n        this._onlyFocus = true;\r\n        this.own(on(this.customContentNode, 'focus', lang.hitch(this, function(){\r\n          if(this._onlyFocus){\r\n            this._onlyFocus = false;\r\n          }else{\r\n            this.customContentNode.scrollTop = 0;\r\n            html.setStyle(this.customContentNode, 'display', 'none');\r\n            // blur current node's focus state. It only works when it's between up and down settings.\r\n            // this.domNode.focus(); //This causes the page to flicker.\r\n            this.customContentNode.blur();\r\n            html.setStyle(this.customContentNode, 'display', 'block');\r\n            setTimeout(lang.hitch(this, function(){\r\n              this._onlyFocus = true;\r\n              this.customContentNode.focus();\r\n            }), 30);\r\n          }\r\n        })));\r\n\r\n        utils.setWABLogoDefaultAlt(this.customContentNode);\r\n\r\n        //focus on first-node when focusing on the container of splash widget at first time.\r\n        this.own(on(this.splashDesktop, 'focus', lang.hitch(this, function(){\r\n          if(this.isFirstFoucs){\r\n            this.isFirstFoucs = false;\r\n            setTimeout(function(){\r\n              focusableNodes[0].focus();\r\n            }, 0);\r\n          }\r\n        })));\r\n      },\r\n\r\n      _setOkNodeAriaLabel: function(){\r\n        var isDisable = this._requireConfirm && !this.confirmCheck.getValue() ? 'true' : 'false';\r\n        html.attr(this.okNode, \"aria-disabled\", isDisable);\r\n      },\r\n\r\n      _setConfig: function() {\r\n        this._setWidthForOldVersion().then(lang.hitch(this, function() {\r\n\r\n          this._setSizeFromConfig();\r\n\r\n          var button = this.config.splash.button;\r\n          if (typeof button !== \"undefined\") {\r\n            if (typeof button.color !== \"undefined\") {\r\n              html.setStyle(this.okNode, 'backgroundColor', button.color);\r\n              html.setStyle(this.okNode, 'color', utils.invertColor(button.color));//auto color for text\r\n            }\r\n            if (typeof button.transparency !== \"undefined\") {\r\n              html.setStyle(this.okNode, 'opacity', (1 - button.transparency));\r\n            }\r\n          }\r\n          this.okNode.innerHTML = this.config.splash.button.text || this.nls.ok;\r\n          html.attr(this.okNode, \"title\", this.config.splash.button.text || this.nls.ok);\r\n          this._setOkNodeAriaLabel();\r\n\r\n          var background = this.config.splash.background;\r\n          if (typeof background !== \"undefined\") {\r\n            //image\r\n            if (\"image\" === background.mode && typeof background.image !== \"undefined\") {\r\n              var bg = \"\", repeat = \"\";\r\n              bg = \"url(\" + utils.processUrlInWidgetConfig(background.image, this.folderUrl) + \") center center \";\r\n              repeat = \"no-repeat\";\r\n\r\n              var type = background.type;\r\n              if (\"undefined\" !== typeof type) {\r\n                html.addClass(this.splashContainerNode, type);\r\n                if (\"tile\" === type) {\r\n                  repeat = \"repeat\";//only \"tile\" need repeat\r\n                }\r\n              }\r\n              html.setStyle(this.splashContainerNode, 'background', bg + repeat);\r\n            } else if (\"color\" === background.mode && typeof background.color !== \"undefined\") {\r\n              //color\r\n              if (\"undefined\" !== typeof background.color) {\r\n                html.setStyle(this.splashContainerBackground, 'backgroundColor', background.color);\r\n              }\r\n              if (\"undefined\" !== typeof background.transparency) {\r\n                html.setStyle(this.splashContainerBackground, 'opacity', (1 - background.transparency));\r\n              }\r\n            }\r\n          }\r\n          //html.setStyle(query(\".label\", this.domNode)[0], 'color', utils.invertColor(background.color));//auto color for text\r\n          var confirm = this.config.splash.confirm;\r\n          if (typeof confirm !== \"undefined\" && this.domNode) {\r\n            var dom = query(\".label\", this.domNode)[0];\r\n            if (\"undefined\" !== typeof confirm.color && dom) {\r\n              html.setStyle(dom, 'color', confirm.color);\r\n            }\r\n            if (\"undefined\" !== typeof confirm.transparency && dom) {\r\n              html.setStyle(dom, 'opacity', (1 - confirm.transparency));\r\n            }\r\n          }\r\n\r\n          if (\"undefined\" !== typeof this.config.splash.contentVertical) {\r\n            this.contentVertical = this.config.splash.contentVertical;\r\n          } else {\r\n            this.contentVertical = \"top\";\r\n          }\r\n\r\n          //resize\r\n          if (!utils.isInConfigOrPreviewWindow()) {\r\n            var isFirstKey = this._getCookieKey();\r\n            var isfirst = cookie(isFirstKey);\r\n            if (esriLang.isDefined(isfirst) && isfirst.toString() === 'false') {\r\n              this.close();\r\n            }\r\n          }\r\n\r\n          this.resize();\r\n          this.own(on(window, 'resize', lang.hitch(this, function() {\r\n            this.resize();\r\n          })));\r\n          this._resizeContentImg();\r\n\r\n          html.removeClass(this.envelopeNode, \"buried\");//show the node\r\n\r\n          var editorPreviewLinkMessager = EditorPreviewLinkMessager.getInstance();\r\n          var isInBuilder;\r\n          try {\r\n            isInBuilder = editorPreviewLinkMessager.isInBuilder();\r\n          } catch(error) {\r\n            isInBuilder = false;\r\n          }\r\n          if (!!isInBuilder && editorPreviewLinkMessager.isHasContent(this._hasContent, this._isClosed)) {\r\n            editorPreviewLinkMessager.filter(this.customContentNode);\r\n          }\r\n\r\n          this.shelter.hide();\r\n        }));\r\n      },\r\n\r\n      _normalizeDomNodePosition: function() {\r\n        html.setStyle(this.domNode, 'top', 0);\r\n        html.setStyle(this.domNode, 'left', 0);\r\n        html.setStyle(this.domNode, 'right', 0);\r\n        html.setStyle(this.domNode, 'bottom', 0);\r\n      },\r\n\r\n      setPosition: function(position) {\r\n        this.position = position;\r\n\r\n        html.place(this.domNode, window.jimuConfig.layoutId);\r\n        this._normalizeDomNodePosition();\r\n        if (this.started) {\r\n          this.resize();\r\n        }\r\n      },\r\n\r\n      resize: function() {\r\n        this._changeStatus();\r\n      },\r\n\r\n      _resizeContentImg: function() {\r\n        if (this._hasContent && !this._isClosed) {\r\n          var customBox = html.getContentBox(this.envelopeNode);\r\n          html.empty(this.customContentNode);\r\n\r\n          var splashContent = html.toDom(this.config.splash.splashContent);\r\n          html.place(splashContent, this.customContentNode);\r\n          // single node only(no DocumentFragment)\r\n          if (this.customContentNode.nodeType && this.customContentNode.nodeType === 1) {\r\n            var contentImgs = query('img', this.customContentNode);\r\n            if (contentImgs && contentImgs.length) {\r\n              contentImgs.style({\r\n                maxWidth: (customBox.w - 40 - 20) + 'px', // prevent x scroll\r\n                maxHeight: (customBox.h - 40) + 'px'\r\n              });\r\n            }\r\n          }\r\n        }\r\n      },\r\n\r\n      _changeStatus: function() {\r\n        if (window.appInfo.isRunInMobile) {\r\n          html.setStyle(this.envelopeNode, 'height', \"100%\");\r\n          html.setStyle(this.envelopeNode, 'width', \"100%\");\r\n        } else {\r\n          this._setSizeFromConfig();\r\n        }\r\n\r\n        this._resizeCustomContent();\r\n        this._resizeContentImg();\r\n      },\r\n      _getNodeStylePx: function(node, prop) {\r\n        if (node && prop) {\r\n          return parseInt(html.getStyle(node, prop), 10);\r\n        } else {\r\n          return 0;\r\n        }\r\n      },\r\n      _resizeCustomContent: function() {\r\n        var containerContent = html.getContentBox(this.splashContainerNode),\r\n          customContentScrollheight = this.customContentNode.scrollHeight,\r\n          footerBox = html.getMarginBox(this.footerNode);\r\n        var contentMarginButtom = this._getNodeStylePx(this.customContentNode, \"margin-bottom\"),//between content & confirm text\r\n          footerBottom = this._getNodeStylePx(this.footerNode, \"bottom\"),//between footer & splashBottom\r\n          contentSpace = containerContent.h - (footerBox.h + footerBottom);\r\n\r\n        var isNeedLimitCustomContentHeight = (customContentScrollheight >= contentSpace);\r\n        if (true === isNeedLimitCustomContentHeight || window.appInfo.isRunInMobile) {\r\n          //limit the customContent height   OR   extend height in mobile\r\n          html.setStyle(this.customContentNode, 'height', (contentSpace - contentMarginButtom) + 'px');\r\n        } else {\r\n          html.setStyle(this.customContentNode, 'height', 'auto');\r\n          this._moveContentToMiddle({\r\n            contentSpace: contentSpace,\r\n            customContentScrollheight: customContentScrollheight\r\n          });\r\n        }\r\n      },\r\n      //align custom content to vertically\r\n      _moveContentToMiddle: function(context) {\r\n        var contentMarginTop = 10,//this._getNodeStylePx(this.customContentNode, \"margin-top\"),\r\n          middleLine = (context.contentSpace - contentMarginTop) / 2;\r\n        //move the content to middle\r\n        if (this.contentVertical === \"middle\") {\r\n          //customContent half-height line is upon the middleLine\r\n          var uponTheMiddleline = context.customContentScrollheight / 2 - middleLine;\r\n          if (uponTheMiddleline < 0) {\r\n            //Content is short\r\n            var abs = Math.abs(uponTheMiddleline);\r\n            html.setStyle(this.customContentNode, 'marginTop', abs + contentMarginTop + 'px');\r\n          } else {\r\n            //Content too long\r\n            html.setStyle(this.customContentNode, 'marginTop', contentMarginTop + 'px');\r\n          }\r\n        }\r\n      },\r\n      onCheckBoxClick: function() {\r\n        if (this._requireConfirm) {\r\n          if (this.confirmCheck.getValue()) {\r\n            html.addClass(this.okNode, 'enable-btn');\r\n            html.removeClass(this.okNode, 'disable-btn');\r\n          } else {\r\n            html.addClass(this.okNode, 'disable-btn');\r\n            html.removeClass(this.okNode, 'enable-btn');\r\n          }\r\n          this._setOkNodeAriaLabel();\r\n        }\r\n      },\r\n\r\n      _getCookieKey: function() {\r\n        return 'isfirst_' + encodeURIComponent(utils.getAppIdFromUrl());\r\n      },\r\n\r\n      onOkClick: function() {\r\n        var isFirstKey = this._getCookieKey();\r\n        if (this._requireConfirm) {\r\n          if (this.confirmCheck.getValue()) {\r\n            if (utils.isInConfigOrPreviewWindow() || this._confirmEverytime) {\r\n              cookie(isFirstKey, null, {expires: -1});\r\n            } else {\r\n              cookie(isFirstKey, false, {\r\n                expires: 1000,\r\n                path: '/'\r\n              });\r\n            }\r\n            this.close();\r\n          }\r\n        } else {\r\n          if (this._showOption) {\r\n            if (!utils.isInConfigOrPreviewWindow() && this.confirmCheck.getValue()) {\r\n              cookie(isFirstKey, false, {\r\n                expires: 1000,\r\n                path: '/'\r\n              });\r\n            }\r\n          } else {\r\n            cookie(isFirstKey, null, {expires: -1});\r\n          }\r\n          this.close();\r\n        }\r\n      },\r\n      onOkKeydown: function(evt){\r\n        if(evt.keyCode === keys.ENTER || evt.keyCode === keys.SPACE){\r\n          this.onOkClick();\r\n          if(!this._requireConfirm || (this._requireConfirm && this.confirmCheck.getValue())){\r\n            utils.focusOnFirstSkipLink();\r\n          }else{\r\n            evt.preventDefault();\r\n          }\r\n        }\r\n      },\r\n\r\n      close: function() {\r\n        this._isClosed = true;\r\n        this._eventHide();\r\n        this.widgetManager.closeWidget(this);\r\n      },\r\n\r\n      _setSizeFromConfig: function() {\r\n        var size = this.config.splash.size;\r\n        if (\"undefined\" !== typeof size) {\r\n          if (typeof size === \"object\") {\r\n            var percent = size.percent;\r\n            var wh = size.wh;\r\n            if (\"percent\" === size.mode && typeof percent !== \"undefined\") {\r\n              html.setStyle(this.envelopeNode, 'width', percent);\r\n              html.setStyle(this.envelopeNode, 'height', percent);\r\n            } else if (\"wh\" === size.mode && typeof wh !== \"undefined\") {\r\n              this._setWidthInCurrentScreen(wh);\r\n              this._setHeightInCurrentScreen(wh);\r\n            }\r\n          }\r\n        }\r\n      },\r\n      //avoid to screen is too small to show the splash, when user use wh pixel\r\n      _setWidthInCurrentScreen: function(wh) {\r\n        var screenWidth = window.innerWidth;\r\n        if (!window.appInfo.isRunInMobile && wh.w <= screenWidth) {\r\n          html.setStyle(this.envelopeNode, 'width', wh.w + \"px\");\r\n        } else {\r\n          html.setStyle(this.envelopeNode, 'width', \"100%\");\r\n        }\r\n      },\r\n      _setHeightInCurrentScreen: function(wh) {\r\n        var screenHeight = window.innerHeight;\r\n        if (!window.appInfo.isRunInMobile && wh.h <= screenHeight) {\r\n          html.setStyle(this.envelopeNode, 'height', wh.h + \"px\");\r\n        } else {\r\n          html.setStyle(this.envelopeNode, 'height', \"100%\");\r\n        }\r\n      },\r\n      //for old version update\r\n      _setWidthForOldVersion: function() {\r\n        var def = new Deferred();\r\n        var size = this.config.splash.size;\r\n        var isOldVersion = (\"wh\" === size.mode && typeof size.wh !== \"undefined\" && null === size.wh.h);\r\n        if (true === isOldVersion) {\r\n          //this._setWhiteColorTextForOldVersion();\r\n          return utils.getEditorContentHeight(this.config.splash.splashContent, this.domNode, {\r\n            \"contentWidth\": 600 - 40,\r\n            \"contentMarginTop\": 20,//contentMarginTop\r\n            \"footerHeight\": 88 + 10//contentMarginBottom\r\n          }).then(\r\n            lang.hitch(this, function(h) {\r\n              size.wh.h = h;\r\n              return h;\r\n            }));\r\n        } else {\r\n          //this._restoreTextColorForNormal();\r\n          def.resolve();\r\n          return def;\r\n        }\r\n      },\r\n      // _setWhiteColorTextForOldVersion: function() {\r\n      //   html.setStyle(this.customContentNode, 'color', \"#fff\");\r\n      // },\r\n      // _restoreTextColorForNormal: function() {\r\n      //   html.setStyle(this.customContentNode, 'color', \"#000\");\r\n      // }\r\n      //event for AppStatePopup\r\n      _eventShow: function () {\r\n        setTimeout(lang.hitch(this, function(){\r\n          topic.publish('splashPopupShow');\r\n        }), 800);// becauseof MapManager._checkAppState setTimeout 500;\r\n      },\r\n      _eventHide: function () {\r\n        topic.publish('splashPopupHide');\r\n      }\r\n    });\r\n    return clazz;\r\n  });"]}