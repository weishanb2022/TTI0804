{"version":3,"sources":["../../../../widgets/Splash/setting/BackgroundSelector.js"],"names":["define","declare","lang","on","html","ColorTransparencyPicker","ImageChooser","_WidgetBase","_TemplatedMixin","_WidgetsInTemplateMixin","template","templateString","nls","_defaultColor","_defaultTransparency","_defaultFillType","_imageMaxSize","postCreate","backgroundColorPicker","backgroundColorPickerEditor","startup","imageChooser","cropImage","showSelfImg","format","GIF","JPEG","PNG","goldenWidth","goldenHeight","maxSize","label","chooseFile","inherited","arguments","_initBgEvent","_selectItem","sizeType","own","colorFillBtn","hitch","_clickColorFillBtn","imageFillBtn","_clickImageFillBtnBtn","data","fileProperty","_showFillsType","_setFileName","fileName","fill","fit","stretch","center","tile","isValid","getValues","bg","mode","image","imageData","type","encodeURIComponent","innerHTML","bgColor","color","transparency","_setColorPicker","setValues","config","splash","background","setDefaultSelfSrc","decodeURIComponent","name","setChecked","addClass","colorFillOptions","imageFillOptions","removeClass","_hideFillsType","fillsType","str"],"mappings":"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","file":"BackgroundSelector.js","sourcesContent":["///////////////////////////////////////////////////////////////////////////\r\n// Copyright Â© Esri. All Rights Reserved.\r\n//\r\n// Licensed under the Apache License Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//    http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n///////////////////////////////////////////////////////////////////////////\r\n\r\ndefine([\r\n    'dojo/_base/declare',\r\n    \"dojo/_base/lang\",\r\n    'dojo/on',\r\n    'dojo/_base/html',\r\n    'jimu/dijit/ColorTransparencyPicker',\r\n    'jimu/dijit/ImageChooser',\r\n    'dijit/_WidgetBase',\r\n    'dijit/_TemplatedMixin',\r\n    'dijit/_WidgetsInTemplateMixin',\r\n    'dojo/text!./BackgroundSelector.html',\r\n    'jimu/dijit/RadioBtn'\r\n  ],\r\n  function(declare, lang, on, html,\r\n           ColorTransparencyPicker, ImageChooser,\r\n           _WidgetBase, _TemplatedMixin, _WidgetsInTemplateMixin, template) {\r\n    return declare([_WidgetBase, _TemplatedMixin, _WidgetsInTemplateMixin], {\r\n      templateString: template,\r\n      nls: null,\r\n      _defaultColor: '#485566',\r\n      _defaultTransparency: 0,\r\n      _defaultFillType: \"fill\",\r\n      _imageMaxSize: (1024),//1M\r\n\r\n      postCreate: function() {\r\n        this.backgroundColorPicker = new ColorTransparencyPicker({},this.backgroundColorPickerEditor);\r\n        this.backgroundColorPicker.startup();\r\n\r\n        this.imageChooser = new ImageChooser({\r\n          cropImage: false,\r\n          showSelfImg: true,\r\n          format: [ImageChooser.GIF, ImageChooser.JPEG, ImageChooser.PNG],\r\n          goldenWidth: 160,\r\n          goldenHeight: 90,\r\n          maxSize: this._imageMaxSize,\r\n          label: this.nls.chooseFile\r\n        }, this.imageChooser);\r\n\r\n        this.inherited(arguments);\r\n      },\r\n      startup: function() {\r\n        this._initBgEvent();\r\n        this._selectItem(this._defaultFillType);\r\n        this.sizeType = this._defaultFillType;\r\n        this.inherited(arguments);\r\n      },\r\n\r\n      _initBgEvent: function() {\r\n        this.own(on(this.colorFillBtn, 'click', lang.hitch(this, function() {\r\n          this._clickColorFillBtn();\r\n        })));\r\n        this.own(on(this.imageFillBtn, 'click', lang.hitch(this, function() {\r\n          this._clickImageFillBtnBtn();\r\n        })));\r\n\r\n        this.own(on(this.imageChooser, 'imageChange', lang.hitch(this, function(data, fileProperty) {\r\n          /* jshint unused: true */\r\n          this._showFillsType();\r\n          if (fileProperty) {\r\n            this._setFileName(fileProperty.fileName);\r\n          }\r\n        })));\r\n\r\n        this.own(on(this.fill, 'click', lang.hitch(this, function() {\r\n          this.sizeType = \"fill\";\r\n        })));\r\n        this.own(on(this.fit, 'click', lang.hitch(this, function() {\r\n          this.sizeType = \"fit\";\r\n        })));\r\n        this.own(on(this.stretch, 'click', lang.hitch(this, function() {\r\n          this.sizeType = \"stretch\";\r\n        })));\r\n        this.own(on(this.center, 'click', lang.hitch(this, function() {\r\n          this.sizeType = \"center\";\r\n        })));\r\n        this.own(on(this.tile, 'click', lang.hitch(this, function() {\r\n          this.sizeType = \"tile\";\r\n        })));\r\n      },\r\n      isValid: function () {\r\n        return this.backgroundColorPicker.isValid();\r\n      },\r\n      getValues: function() {\r\n        var bg = {};\r\n        bg.mode = this.mode;\r\n        //if (\"image\" === this.mode) {\r\n        //image\r\n        bg.image = this.imageChooser.imageData;\r\n        bg.type = this.sizeType;\r\n        bg.fileName = encodeURIComponent(this.fileName.innerHTML);\r\n        //} else {\r\n        //color\r\n        var bgColor = this.backgroundColorPicker.getValues();\r\n        bg.color = bgColor.color;\r\n        bg.transparency = bgColor.transparency;\r\n        //}\r\n        return bg;\r\n      },\r\n      _setColorPicker: function(bg) {\r\n        var color = this._defaultColor;\r\n        var transparency = this._defaultTransparency;\r\n        if (bg) {\r\n          color = bg.color;\r\n          transparency = bg.transparency;\r\n        }\r\n\r\n        this.backgroundColorPicker.setValues({\r\n          \"color\": color,\r\n          \"transparency\": transparency\r\n        });\r\n      },\r\n      setValues: function(config) {\r\n        if (\"undefined\" !== typeof config.splash && \"undefined\" !== typeof config.splash.background) {\r\n          var bg = config.splash.background;\r\n          //if (\"image\" === bg.mode) {\r\n          //this._setColorPicker();\r\n          // } else {\r\n          this._setColorPicker(bg);\r\n          if (bg.image) {\r\n            this.imageChooser.setDefaultSelfSrc(bg.image);\r\n            this._showFillsType();\r\n          }\r\n          if (bg.fileName) {\r\n            this.fileName.innerHTML = decodeURIComponent(bg.fileName);\r\n          }\r\n          if (bg.type) {\r\n            this._selectItem(bg.type);\r\n            this.sizeType = bg.type;\r\n          }\r\n\r\n          if (\"image\" === bg.mode) {\r\n            this._selectItem(\"imageFillBtn\");\r\n            this._clickImageFillBtnBtn();\r\n          } else {\r\n            this._selectItem(\"colorFillBtn\");\r\n            this._clickColorFillBtn();\r\n          }\r\n          //}\r\n          // } else {\r\n          //   this._setColorPicker();\r\n          //   this._selectItem(\"colorFillBtn\");\r\n          //   this._clickColorFillBtn();\r\n        }\r\n      },\r\n      _selectItem: function(name) {\r\n        if(this[name] && this[name].setChecked){\r\n          this[name].setChecked(true);\r\n        }\r\n      },\r\n      _clickColorFillBtn: function() {\r\n        html.addClass(this.colorFillOptions, 'hide');\r\n        html.addClass(this.imageFillOptions, 'hide');\r\n        html.removeClass(this.colorFillOptions, 'hide');\r\n        this.mode = \"color\";\r\n      },\r\n      _clickImageFillBtnBtn: function() {\r\n        html.addClass(this.colorFillOptions, 'hide');\r\n        html.addClass(this.imageFillOptions, 'hide');\r\n        html.removeClass(this.imageFillOptions, 'hide');\r\n        this.mode = \"image\";\r\n      },\r\n      _hideFillsType: function() {\r\n        html.addClass(this.fillsType, 'hide');\r\n      },\r\n      _showFillsType: function() {\r\n        html.removeClass(this.fillsType, 'hide');\r\n      },\r\n      _setFileName: function(str) {\r\n        this.fileName.innerHTML = str;\r\n      }\r\n    });\r\n  });"]}