{"version":3,"sources":["../../../widgets/OverviewMap/Widget.js"],"names":["define","declare","lang","html","array","on","Deferred","aspect","BaseWidget","OverviewMap","jimuUtils","utils","domStyle","a11y","clazz","baseClass","overviewMapDijit","_showDijit","_handles","startup","inherited","arguments","createOverviewMap","map","own","hitch","_onMainMapBasemapChange","setPosition","position","place","domNode","id","_processAttachTo","config","started","_updateDomPosition","overviewMap","attachTo","top","undefined","left","window","isRTL","right","bottom","initPos","width","zIndex","_position","_getOverviewPositionByAttach","mixin","style","getPositionStyle","set","removeClass","arrowStyle","addClass","visible","json","clone","_isShow","_hasMaximizeButton","maximizeButton","height","expandFactor","_getBaseLayerMap","then","res","layer","baseLayer","push","after","appendChild","a11y_init","a11y_initEvents","a11y_forLaunchpadThemeStyle","show","isFinite","evt","_basemapGalleryLayerType","_destroyOverviewMap","onPositionChange","forEach","handle","remove","destroy","empty","onReceiveData","name","onOpen","onClose","_afterOverviewHide","_afterOverviewShow","def","createBaseLayer","resolve","extend"],"mappings":"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","file":"Widget.js","sourcesContent":["///////////////////////////////////////////////////////////////////////////\r\n// Copyright Â© Esri. All Rights Reserved.\r\n//\r\n// Licensed under the Apache License Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//    http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n///////////////////////////////////////////////////////////////////////////\r\n\r\ndefine([\r\n  'dojo/_base/declare',\r\n  'dojo/_base/lang',\r\n  'dojo/_base/html',\r\n  'dojo/_base/array',\r\n  'dojo/on',\r\n  'dojo/Deferred',\r\n  'dojo/aspect',\r\n  'jimu/BaseWidget',\r\n  'esri/dijit/OverviewMap',\r\n  'jimu/utils',\r\n  './utils',\r\n  \"dojo/dom-style\",\r\n  \"./a11y/Widget\"\r\n],\r\n  function (declare, lang, html, array, on, Deferred, aspect,\r\n    BaseWidget, OverviewMap, jimuUtils, utils, domStyle, a11y) {\r\n    var clazz = declare([BaseWidget], {\r\n      baseClass: 'jimu-widget-overview',\r\n      overviewMapDijit: null,\r\n      _showDijit: false,\r\n      _handles: null,\r\n\r\n      startup: function () {\r\n        this._handles = [];\r\n        this.inherited(arguments);\r\n        this.createOverviewMap();//for \"Initially expand the widget\"\r\n\r\n        if (this.map) {\r\n          this.own(on(this.map, 'layer-add', lang.hitch(this, this._onMainMapBasemapChange)));\r\n          //this.own(on(this.map, 'resize', lang.hitch(this, this._onMainMapResize)));\r\n        }\r\n      },\r\n\r\n      setPosition: function (position) {\r\n        this.position = position;\r\n        html.place(this.domNode, this.map.id);\r\n        this._processAttachTo(this.config, position);\r\n        if (this.started) {\r\n          this._updateDomPosition(this.config.overviewMap.attachTo);\r\n        }\r\n      },\r\n\r\n      _processAttachTo: function (config, position) {\r\n        if (typeof config.overviewMap === \"undefined\") {\r\n          config.overviewMap = {};\r\n        }\r\n        //set a default \"attachTo\" by position\r\n        if (typeof config.overviewMap.attachTo === \"undefined\" && position) {\r\n          if (position.top !== undefined && position.left !== undefined) {\r\n            config.overviewMap.attachTo = !window.isRTL ? \"top-left\" : \"top-right\";\r\n          } else if (position.top !== undefined && position.right !== undefined) {\r\n            config.overviewMap.attachTo = !window.isRTL ? \"top-right\" : \"top-left\";\r\n          } else if (position.bottom !== undefined && position.left !== undefined) {\r\n            config.overviewMap.attachTo = !window.isRTL ? \"bottom-left\" : \"bottom-right\";\r\n          } else if (position.bottom !== undefined && position.right !== undefined) {\r\n            config.overviewMap.attachTo = !window.isRTL ? \"bottom-right\" : \"bottom-left\";\r\n          }\r\n        }\r\n      },\r\n\r\n      _updateDomPosition: function (attachTo) {\r\n        if (this.overviewMapDijit) {\r\n          var initPos = {\r\n            left: 'auto',\r\n            right: 'auto',\r\n            top: 'auto',\r\n            bottom: 'auto',\r\n            width: 'auto',\r\n            zIndex: (this.position && this.position.zIndex) || 0\r\n          };\r\n          var _position = this._getOverviewPositionByAttach(attachTo);\r\n          lang.mixin(initPos, _position);\r\n          var style = jimuUtils.getPositionStyle(initPos);\r\n          style.position = 'absolute';\r\n          domStyle.set(this.domNode, style);\r\n          domStyle.set(this.overviewMapDijit.domNode, style);\r\n\r\n          //change arrow style\r\n          if (this.overviewMapDijit.domNode) {\r\n            html.removeClass(this.overviewMapDijit.domNode, [\"ovwTL\", \"ovwTR\", \"ovwBL\", \"ovwBR\"]);\r\n            var arrowStyle = \"\";\r\n            switch (attachTo) {\r\n              case \"top-left\": {\r\n                arrowStyle = \"ovwTL\";\r\n                break;\r\n              } case \"top-right\": {\r\n                arrowStyle = \"ovwTR\";\r\n                break;\r\n              } case \"bottom-left\": {\r\n                arrowStyle = \"ovwBL\";\r\n                break;\r\n              } case \"bottom-right\": {\r\n                arrowStyle = \"ovwBR\";\r\n                break;\r\n              } default: {\r\n                arrowStyle = \"ovwTL\";\r\n                break;\r\n              }\r\n            }\r\n            html.addClass(this.overviewMapDijit.domNode, arrowStyle);\r\n            html.addClass(this.domNode, arrowStyle);//for a11y\r\n          }\r\n        }\r\n      },\r\n\r\n      createOverviewMap: function (visible) {\r\n        var json = lang.clone(this.config.overviewMap);\r\n        json.map = this.map;\r\n        if (visible !== undefined) {\r\n          json.visible = visible;\r\n        }\r\n        //this._processAttachTo(json, this.position);\r\n        // overviewMap dijit has bug in IE8\r\n        var _isShow = json.visible;\r\n        json.visible = false;\r\n\r\n        var _hasMaximizeButton = 'maximizeButton' in json;\r\n        json.maximizeButton = _hasMaximizeButton ? json.maximizeButton : true;\r\n        json.width = 200;\r\n        json.height = 200;\r\n        json.expandFactor = 2;//50\r\n        //json.opacity = 0.5;\r\n        json.attachTo = this.config.overviewMap.attachTo;\r\n\r\n        this._getBaseLayerMap().then(lang.hitch(this, function (res) {\r\n          if (res && res.layer && \"string\" !== typeof res.layer) {\r\n            json.baseLayer = res.layer;\r\n          } else if (json.baseLayer) {\r\n            delete json.baseLayer;//reset to raw basemap\r\n          }\r\n\r\n          this.overviewMapDijit = new OverviewMap(json);\r\n          this._handles.push(aspect.after(\r\n            this.overviewMapDijit,\r\n            'show',\r\n            lang.hitch(this, '_afterOverviewShow')\r\n          ));\r\n          this._handles.push(aspect.after(\r\n            this.overviewMapDijit,\r\n            'hide',\r\n            lang.hitch(this, '_afterOverviewHide')\r\n          ));\r\n          this.overviewMapDijit.startup();\r\n\r\n          this._updateDomPosition(json.attachTo);\r\n          this.domNode.appendChild(this.overviewMapDijit.domNode);\r\n\r\n          this.a11y_init();\r\n          this.a11y_initEvents();\r\n          this.a11y_forLaunchpadThemeStyle();\r\n\r\n          if (_isShow) {\r\n            this.overviewMapDijit.show();\r\n          }\r\n        }));\r\n      },\r\n\r\n      _getOverviewPositionByAttach: function (attachTo) {\r\n        var _position = {};\r\n        if (attachTo === 'top-left') {\r\n          _position.left = 0;\r\n          _position.top = 0;\r\n        } else if (attachTo === 'top-right') {\r\n          _position.right = 0;\r\n          _position.top = 0;\r\n        } else if (attachTo === 'bottom-left') {\r\n          _position.bottom = 0;\r\n          _position.left = 0;\r\n        } else if (attachTo === 'bottom-right') {\r\n          _position.bottom = 0;\r\n          _position.right = 0;\r\n        }\r\n\r\n        if (window.isRTL) {\r\n          if (isFinite(_position.left)) {\r\n            _position.right = _position.left;\r\n            delete _position.left;\r\n          } else {\r\n            _position.left = _position.right;\r\n            delete _position.right;\r\n          }\r\n        }\r\n\r\n        return _position;\r\n      },\r\n\r\n      _onMainMapBasemapChange: function (evt) {\r\n        if (!(evt.layer && evt.layer._basemapGalleryLayerType)) {\r\n          return;\r\n        }\r\n\r\n        this._destroyOverviewMap();\r\n        this.createOverviewMap(this._showDijit);\r\n      },\r\n\r\n      onPositionChange: function (position) {\r\n        this.position = position;\r\n        if (this.config.overviewMap.attachTo) {\r\n          return;\r\n        }\r\n\r\n        this._destroyOverviewMap();\r\n        this.createOverviewMap(this._showDijit);\r\n      },\r\n\r\n      _destroyOverviewMap: function () {\r\n        array.forEach(this._handles, function (handle) {\r\n          if (handle && typeof handle.remove === 'function') {\r\n            handle.remove();\r\n          }\r\n        });\r\n        if (this.overviewMapDijit && this.overviewMapDijit.destroy) {\r\n          this.overviewMapDijit.destroy();\r\n          this.overviewMapDijit = null;\r\n          html.empty(this.domNode);\r\n        }\r\n      },\r\n\r\n      //_onMainMapResize: function() {\r\n      //  this._destroyOverviewMap();\r\n      //  this.createOverviewMap(this._showDijit);\r\n      //},\r\n\r\n      onReceiveData: function (name) {\r\n        if (name !== \"BasemapGallery\") {\r\n          return;\r\n        }\r\n\r\n        this._destroyOverviewMap();\r\n        this.createOverviewMap(this._showDijit);\r\n      },\r\n\r\n      onOpen: function () {\r\n        this._destroyOverviewMap();\r\n        this.createOverviewMap(this._showDijit);\r\n      },\r\n\r\n      onClose: function () {\r\n        this._destroyOverviewMap();\r\n      },\r\n\r\n      _afterOverviewHide: function () {\r\n        this._showDijit = false;\r\n        domStyle.set(this.domNode, {\r\n          width: \"auto\",\r\n          height: \"auto\"\r\n        });\r\n      },\r\n\r\n      _afterOverviewShow: function () {\r\n        this._showDijit = true;\r\n        domStyle.set(this.domNode, {\r\n          width: this.overviewMapDijit.width + 'px',\r\n          height: this.overviewMapDijit.height + 'px'\r\n        });\r\n      },\r\n\r\n      _getBaseLayerMap: function () {\r\n        var def = new Deferred();\r\n        if (this.config.overviewMap && this.config.overviewMap.baseLayer) {\r\n          utils.createBaseLayer(this.config.overviewMap.baseLayer, this.map, this).then(function (layer) {\r\n            def.resolve(layer);\r\n          });\r\n        } else {\r\n          def.resolve(null);\r\n        }\r\n\r\n        return def;\r\n      }\r\n    });\r\n\r\n    clazz.extend(a11y);//for a11y\r\n    return clazz;\r\n  });"]}