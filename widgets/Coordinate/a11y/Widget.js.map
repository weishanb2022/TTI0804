{"version":3,"sources":["../../../../widgets/Coordinate/a11y/Widget.js"],"names":["define","lang","on","html","keys","jimuUtils","a11yclick","mo","a11y_init","options","initFirstFocusNode","domNode","locateButton","isHidePopmenu","initLastFocusNode","foldableNode","a11y_initEvents","own","hitch","onLocateButtonClick","foldContainer","onFoldContainerClick","evt","keyCode","UP_ARROW","DOWN_ARROW","a11y_setCoordinateInfo","str","labelDom","coordinateInfo","widgetDom","innerHTML","sanitizeHTML","setAttr","_isKeyEvent","_origType","a11y_initPopMenuEvents","popMenu","ESCAPE","stopPropagation","preventDefault","setTimeout","focus","a11y_bindMenuItemEvent","menuItem","a11y_focusToPopMenuBtn","a11y_focusMenuItem","selectedItem"],"mappings":"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","file":"Widget.js","sourcesContent":["///////////////////////////////////////////////////////////////////////////\r\n// Copyright Â© Esri. All Rights Reserved.\r\n//\r\n// Licensed under the Apache License Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//    http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n///////////////////////////////////////////////////////////////////////////\r\n\r\ndefine([\r\n  'dojo/_base/lang',\r\n  'dojo/on',\r\n  //'dojo/Deferred',\r\n  'dojo/_base/html',\r\n  'dojo/keys',\r\n  'jimu/utils',\r\n  \"dijit/a11yclick\"\r\n],\r\n  function (lang, on,/*Deferred, */html, keys, jimuUtils, a11yclick) {\r\n    var mo = {};\r\n\r\n    mo.a11y_init = function (options) {\r\n      jimuUtils.initFirstFocusNode(this.domNode, this.locateButton);\r\n\r\n      if (options && options.isHidePopmenu) {\r\n        jimuUtils.initLastFocusNode(this.domNode, this.locateButton);\r\n      } else {\r\n        jimuUtils.initLastFocusNode(this.domNode, this.foldableNode);\r\n      }\r\n    };\r\n\r\n    mo.a11y_initEvents = function () {\r\n      this.own(on(this.locateButton, a11yclick, lang.hitch(this, this.onLocateButtonClick)));\r\n\r\n      this.own(on(this.foldContainer, a11yclick, lang.hitch(this, this.onFoldContainerClick)));\r\n      this.own(on(this.foldContainer, \"keydown\", lang.hitch(this, function (evt) {\r\n        if (evt.keyCode === keys.UP_ARROW || evt.keyCode === keys.DOWN_ARROW) {\r\n          this.onFoldContainerClick();\r\n        }\r\n      })));\r\n    };\r\n\r\n    mo.a11y_setCoordinateInfo = function (str) {\r\n      var labelDom = this.coordinateInfo;\r\n      var widgetDom = this.domNode;\r\n      if (labelDom) {\r\n        labelDom.innerHTML = jimuUtils.sanitizeHTML(str);\r\n      }\r\n\r\n      if (widgetDom) {\r\n        html.setAttr(widgetDom, 'aria-label', str);\r\n      }\r\n    };\r\n\r\n    mo._isKeyEvent = function (evt) {\r\n      if (evt && evt._origType) {//: \"keyup\"\r\n        return true;\r\n      }\r\n\r\n      return false;\r\n    };\r\n\r\n    /* popUp */\r\n    mo.a11y_initPopMenuEvents = function () {\r\n      this.own(on(this.popMenu.domNode, \"keydown\", lang.hitch(this, function (evt) {\r\n        if (evt.keyCode === keys.ESCAPE) {\r\n          //esc to close popup\r\n          evt.stopPropagation();\r\n          evt.preventDefault();\r\n\r\n          this.onFoldContainerClick();\r\n\r\n          setTimeout(lang.hitch(this, function () {\r\n            this.foldableNode.focus();\r\n          }), 0);\r\n        }\r\n      })));\r\n    };\r\n\r\n    mo.a11y_bindMenuItemEvent = function (menuItem) {\r\n      this.own(on(menuItem, \"click\", lang.hitch(this, function (evt) {\r\n        if (mo._isKeyEvent(evt)) {\r\n          setTimeout(lang.hitch(this, function () {\r\n            this.a11y_focusToPopMenuBtn();//just for keyboard events\r\n          }), 0);\r\n        }\r\n      })));\r\n    };\r\n\r\n    mo.a11y_focusMenuItem = function () {\r\n      this.selectedItem.domNode.focus();\r\n    };\r\n\r\n    mo.a11y_focusToPopMenuBtn = function () {\r\n      this.foldableNode.focus();\r\n    };\r\n\r\n    return mo;\r\n  });"]}