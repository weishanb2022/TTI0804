{"version":3,"sources":["../../../widgets/HomeButton/Widget.js"],"names":["define","declare","lang","BaseWidget","HomeButton","Extent","SpatialReference","html","domConstruct","topic","keys","on","clazz","name","baseClass","moveTopOnActive","postCreate","setAttr","domNode","window","apiNls","widgets","homeButton","home","title","own","subscribe","hitch","onAppConfigChanged","startup","initalExtent","inherited","arguments","map","configExtent","appConfig","mapOptions","extent","xmin","ymin","xmax","ymax","spatialReference","_initialExtent","createHomeDijit","options","homeDijit","create","onHomeKeyDown","place","reason","changedData","set","onExtentChange","removeClass","evt","keyCode","ENTER","SPACE","onHome","error","addClass"],"mappings":"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","file":"Widget.js","sourcesContent":["///////////////////////////////////////////////////////////////////////////\r\n// Copyright Â© Esri. All Rights Reserved.\r\n//\r\n// Licensed under the Apache License Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//    http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n///////////////////////////////////////////////////////////////////////////\r\n\r\ndefine([\r\n    'dojo/_base/declare',\r\n    'dojo/_base/lang',\r\n    'jimu/BaseWidget',\r\n    \"esri/dijit/HomeButton\",\r\n    \"esri/geometry/Extent\",\r\n    'esri/SpatialReference',\r\n    'dojo/_base/html',\r\n    'dojo/dom-construct',\r\n    'dojo/topic',\r\n    'dojo/keys',\r\n    'dojo/on'\r\n  ],\r\n  function(\r\n    declare,\r\n    lang,\r\n    BaseWidget,\r\n    HomeButton,\r\n    Extent,\r\n    SpatialReference,\r\n    html,\r\n    domConstruct,\r\n    topic,\r\n    keys,\r\n    on) {\r\n    var clazz = declare([BaseWidget], {\r\n\r\n      name: 'HomeButton',\r\n      baseClass: 'jimu-widget-homebutton',\r\n\r\n      moveTopOnActive: false,\r\n\r\n      postCreate: function() {\r\n        html.setAttr(this.domNode, 'aria-label', window.apiNls.widgets.homeButton.home.title);\r\n        this.own(topic.subscribe(\"appConfigChanged\", lang.hitch(this, this.onAppConfigChanged)));\r\n      },\r\n\r\n      startup: function() {\r\n        var initalExtent = null;\r\n        this.inherited(arguments);\r\n        this.own(on(this.map, 'extent-change', lang.hitch(this, 'onExtentChange')));\r\n\r\n        var configExtent = this.appConfig && this.appConfig.map &&\r\n          this.appConfig.map.mapOptions && this.appConfig.map.mapOptions.extent;\r\n\r\n        if (configExtent) {\r\n          initalExtent = new Extent(\r\n            configExtent.xmin,\r\n            configExtent.ymin,\r\n            configExtent.xmax,\r\n            configExtent.ymax,\r\n            new SpatialReference(configExtent.spatialReference)\r\n          );\r\n        } else {\r\n          initalExtent = this.map._initialExtent || this.map.extent;\r\n        }\r\n\r\n        this.createHomeDijit({\r\n          map: this.map,\r\n          extent: initalExtent\r\n        });\r\n      },\r\n\r\n      createHomeDijit: function(options) {\r\n        this.homeDijit = new HomeButton(options, domConstruct.create(\"div\"));\r\n        this.own(on(this.homeDijit, 'home', lang.hitch(this, 'onHome')));\r\n        this.own(on(this.domNode, 'keydown', lang.hitch(this, this.onHomeKeyDown)));\r\n        html.place(this.homeDijit.domNode, this.domNode);\r\n        this.homeDijit.startup();\r\n      },\r\n\r\n      onAppConfigChanged: function(appConfig, reason, changedData) {\r\n        if (reason === \"mapOptionsChange\" && changedData && appConfig &&\r\n          changedData.extent) {\r\n          var extent = new Extent(changedData.extent);\r\n          this.homeDijit.set(\"extent\", extent);\r\n        }\r\n      },\r\n\r\n      onExtentChange: function() {\r\n        html.removeClass(this.domNode, 'inHome');\r\n      },\r\n\r\n      onHomeKeyDown: function(evt){\r\n        if(evt.keyCode === keys.ENTER || evt.keyCode === keys.SPACE){\r\n          this.homeDijit.home();//trigger home event\r\n        }\r\n      },\r\n\r\n      onHome: function(evt) {\r\n        if (!(evt && evt.error)) {\r\n          html.addClass(this.domNode, 'inHome');\r\n        }\r\n      }\r\n    });\r\n    return clazz;\r\n  });"]}