{"version":3,"sources":["../../../widgets/AddData/Widget.js"],"names":["define","declare","lang","on","aspect","Deferred","domClass","portalUrlUtils","portalUtils","tokenUtils","BaseWidget","TabContainer3","_WidgetsInTemplateMixin","SearchContext","util","SearchPane","AddFromUrlPane","AddFromFilePane","LayerListPane","array","name","baseClass","batchGeocoderServers","isPortal","_isOpen","_searchOnOpen","tabContainer","searchPane","addFromUrlPane","addFromFilePane","postCreate","inherited","arguments","startup","_started","self","args","_getUser","then","user","_checkConfig","_initTabs","_initContext","_initFooter","_initListeners","resize","otherwise","error","console","warn","config","initOption","options","opt","allow","label","filter","trim","length","scopeOptions","getSharingUrl","p","getPortal","appConfig","portalUrl","dfd","userHaveSignInPortal","getUser","resolve","_initBatchGeocoder","portal","roleOK","regexWorld","regexWorldProxy","geocodeServers","helperServices","geocode","isWorld","isWorldProxy","batchGeocodeServers","privileges","indexOf","forEach","server","url","match","batch","push","bResolve","arcgisOnlineUrl","checkMixedContent","hasUsername","username","searchContext","orgId","id","MyContent","kmlsvc","replace","window","esri","defaults","kmlService","geoRSSService","ex","msg","nls","search","loadError","arcgisOnlineOption","ArcGISOnline","allowArcGISOnline","arcgisOnlinePortal","loadSelfInfo","MyOrganization","parentNode","widgets","searchWidget","hasSearchFooter","footerNode","nodeName","footerContainer","document","createElement","className","appendChild","layerListBtn","href","innerHTML","layerList","caption","own","hitch","evt","preventDefault","showLayers","messageNode","targetNode","containerNode","domNode","title","_setStatus","style","display","tabs","map","bboxOption","bboxToggle","get","supportsFile","File","FileReader","FormData","allowSearch","chkAllowSearch","wabWidget","searchNode","content","addFromUrl","urlNode","addFromFile","fileNode","file","average","tabsNode","controlNode","top","ex1","after","createTextNode","noOptionsConfigured","setNodeText","onClose","onOpen","bSearch","widgetWidth","clientWidth","widgetHeight","clientHeight","remove","add","layerListPane","placeAt","show"],"mappings":"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","file":"Widget.js","sourcesContent":["///////////////////////////////////////////////////////////////////////////\r\n// Copyright © Esri. All Rights Reserved.\r\n//\r\n// Licensed under the Apache License Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//    http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n///////////////////////////////////////////////////////////////////////////\r\ndefine([\"dojo/_base/declare\",\r\n    \"dojo/_base/lang\",\r\n    \"dojo/on\",\r\n    \"dojo/aspect\",\r\n    \"dojo/Deferred\",\r\n    \"dojo/dom-class\",\r\n    \"jimu/portalUrlUtils\",\r\n    \"jimu/portalUtils\",\r\n    \"jimu/tokenUtils\",\r\n    \"jimu/BaseWidget\",\r\n    \"jimu/dijit/TabContainer3\",\r\n    \"dijit/_WidgetsInTemplateMixin\",\r\n    \"./search/SearchContext\",\r\n    \"./search/util\",\r\n    \"./search/SearchPane\",\r\n    \"./search/AddFromUrlPane\",\r\n    \"./search/AddFromFilePane\",\r\n    \"./search/LayerListPane\",\r\n    \"dojo/_base/array\"\r\n  ],\r\n  function(declare, lang, on, aspect, Deferred, domClass, portalUrlUtils, portalUtils,\r\n    tokenUtils, BaseWidget, TabContainer3, _WidgetsInTemplateMixin, SearchContext,\r\n    util, SearchPane, AddFromUrlPane, AddFromFilePane, LayerListPane, array) {\r\n    return declare([BaseWidget, _WidgetsInTemplateMixin], {\r\n\r\n      name: \"AddData\",\r\n      baseClass: \"jimu-widget-add-data\",\r\n\r\n      batchGeocoderServers: null,\r\n      isPortal: false,\r\n\r\n      _isOpen: false,\r\n      _searchOnOpen: false,\r\n\r\n      tabContainer: null,\r\n      searchPane: null,\r\n      addFromUrlPane: null,\r\n      addFromFilePane: null,\r\n\r\n      postCreate: function() {\r\n        this.inherited(arguments);\r\n      },\r\n\r\n      startup: function() {\r\n        if (this._started) {\r\n          return;\r\n        }\r\n        var self = this,  args = arguments;\r\n        this._getUser().then(function(user) {\r\n          //console.warn(\"AddData.user=\",user);\r\n          self._checkConfig();\r\n          self._initTabs();\r\n          return self._initContext(user);\r\n        }).then(function() {\r\n          self.inherited(args);\r\n          if (self.tabContainer) {\r\n            self.tabContainer.startup();\r\n          } else if (self.searchPane) {\r\n            self.searchPane.startup();\r\n          } else if (self.addFromUrlPane) {\r\n            self.addFromUrlPane.startup();\r\n          } else if (self.addFromFilePane) {\r\n            self.addFromFilePane.startup();\r\n          }\r\n          self._initFooter(self.tabContainer, {\r\n            \"searchWidget\": self.searchPane,\r\n            \"addFromUrlWidget\": self.addFromUrlPane,\r\n            \"addFromFileWidget\": self.addFromFilePane\r\n          });\r\n          self._initListeners();\r\n          self.resize();\r\n          //console.warn(\"AddData.startup\",this);\r\n        }).otherwise(function(error) {\r\n          console.warn(\"AddData.startup error:\", error);\r\n          self.inherited(args);\r\n          self.resize();\r\n        });\r\n      },\r\n\r\n      _checkConfig: function() {\r\n        if (!this.config) {\r\n          this.config = {};\r\n        }\r\n        var initOption = function(options,name) {\r\n          var opt = options[name];\r\n          if (!opt) {\r\n            opt = options[name] = {\r\n              allow: true,\r\n              label: null\r\n            };\r\n          }\r\n          if (typeof opt.allow !== \"boolean\") {\r\n            opt.allow = true;\r\n          }\r\n          if (name === \"Curated\") {\r\n            if (typeof opt.filter !== \"string\" || lang.trim(opt.filter).length === 0) {\r\n              opt.allow = false;\r\n            }\r\n          }\r\n        };\r\n        var config = this.config;\r\n        if (!config.scopeOptions) {\r\n          config.scopeOptions = {};\r\n        }\r\n        var options = config.scopeOptions;\r\n        initOption(options,\"MyContent\");\r\n        initOption(options,\"MyOrganization\");\r\n        initOption(options,\"Curated\");\r\n        initOption(options,\"ArcGISOnline\");\r\n        initOption(config,\"addFromUrl\");\r\n        initOption(config,\"addFromFile\");\r\n      },\r\n\r\n      getSharingUrl: function() {\r\n        var p = portalUtils.getPortal(this.appConfig.portalUrl);\r\n        return portalUrlUtils.getSharingUrl(p.portalUrl);\r\n      },\r\n\r\n      _getUser: function() {\r\n        var dfd = new Deferred();\r\n        var portalUrl = this.appConfig.portalUrl;\r\n        if (tokenUtils.userHaveSignInPortal(portalUrl)) {\r\n          portalUtils.getPortal(portalUrl).getUser().then(function(user) {\r\n            dfd.resolve(user);\r\n          }).otherwise(function(error) {\r\n            console.warn(\"AddData._getUser error:\", error);\r\n            dfd.resolve(null);\r\n          });\r\n        } else {\r\n          dfd.resolve(null);\r\n        }\r\n        return dfd;\r\n      },\r\n\r\n      _initBatchGeocoder: function(portal,user) {\r\n        //console.warn(\"_initBatchGeocoder.portal\",portal);\r\n        //console.warn(\"_initBatchGeocoder.user\",user);\r\n        var roleOK = false;\r\n        var regexWorld = /(arcgis.com\\/arcgis\\/rest\\/services\\/world\\/geocodeserver).*/ig;\r\n        var regexWorldProxy = /(\\/servers\\/[\\da-z\\.-]+\\/rest\\/services\\/world\\/geocodeserver).*/ig;\r\n        var geocodeServers = portal && portal.helperServices && portal.helperServices.geocode || [];\r\n        var isWorld, isWorldProxy, batchGeocodeServers = [];\r\n        if (user && user.privileges) {\r\n          roleOK = array.indexOf(user.privileges, \"premium:user:geocode\") > -1;\r\n        }\r\n        array.forEach(geocodeServers, function (server) {\r\n          isWorld = !!server.url.match(regexWorld);\r\n          isWorldProxy = !!server.url.match(regexWorldProxy);\r\n          if ((isWorld && !portal.isPortal && roleOK) || isWorldProxy || !!server.batch) {\r\n            batchGeocodeServers.push({\r\n              \"isWorldGeocodeServer\": isWorld || isWorldProxy,\r\n              \"isWorldGeocodeServerProxy\": isWorldProxy,\r\n              \"label\": server.name,\r\n              \"value\": server.url,\r\n              \"url\": server.url,\r\n              \"name\": server.name\r\n            });\r\n          }\r\n        });\r\n        this.batchGeocoderServers = batchGeocodeServers;\r\n        //console.warn(\"batchGeocoderServers\",this.batchGeocoderServers);\r\n      },\r\n\r\n      _initContext: function(user) {\r\n        var dfd = new Deferred(), bResolve = true;\r\n        // TODO configure this?\r\n        var arcgisOnlineUrl = util.checkMixedContent(\"http://www.arcgis.com\");\r\n        var scopeOptions = this.config.scopeOptions;\r\n        var hasUsername = (user && typeof user.username === \"string\" && user.username.length > 0);\r\n        var searchContext = new SearchContext();\r\n        var portal = portalUtils.getPortal(this.appConfig.portalUrl);\r\n        this.isPortal = portal.isPortal;\r\n        searchContext.portal = portal;\r\n\r\n        // Issue #14908\r\n        if (portal.isPortal) {\r\n          searchContext.orgId = portal.id;\r\n        }\r\n\r\n        if (user) {\r\n          if (typeof user.orgId === \"string\" && user.orgId.length > 0) {\r\n            searchContext.orgId = user.orgId;\r\n          }\r\n        }\r\n        if (hasUsername) {\r\n          searchContext.username = user.username;\r\n        } else {\r\n          scopeOptions.MyContent.allow = false;\r\n        }\r\n        if (this.searchPane) {\r\n          this.searchPane.searchContext = searchContext;\r\n          this.searchPane.portal = portal;\r\n        }\r\n        this._initBatchGeocoder(portal,user);\r\n\r\n        // KML and GeoRSS utility services\r\n        if (portal.isPortal) {\r\n          try {\r\n            var kmlsvc = portalUrlUtils.getSharingUrl(portal.portalUrl) + \"/kml\";\r\n            kmlsvc = kmlsvc.replace(\"/sharing/rest/kml\",\"/sharing/kml\");\r\n            window.esri.config.defaults.kmlService = kmlsvc;\r\n            window.esri.config.defaults.geoRSSService = kmlsvc.replace(\"/kml\",\"/rss\");\r\n          } catch(ex) {\r\n            console.error(ex);\r\n          }\r\n        }\r\n\r\n        //console.warn(\"AddData.portal\",portal);\r\n        var msg = this.nls.search.loadError + arcgisOnlineUrl;\r\n        var arcgisOnlineOption = scopeOptions.ArcGISOnline;\r\n        searchContext.allowArcGISOnline = arcgisOnlineOption.allow;\r\n        if (portal.isPortal && searchContext.allowArcGISOnline) {\r\n          var arcgisOnlinePortal = portalUtils.getPortal(arcgisOnlineUrl);\r\n          if (!arcgisOnlinePortal) {\r\n            console.warn(msg);\r\n            searchContext.allowArcGISOnline = false;\r\n            arcgisOnlineOption.allow = false;\r\n          } else {\r\n            if (!arcgisOnlinePortal.helperServices) {\r\n              bResolve = false;\r\n              arcgisOnlinePortal.loadSelfInfo().then(function() {\r\n                if (!arcgisOnlinePortal.helperServices) {\r\n                  console.warn(msg);\r\n                  searchContext.allowArcGISOnline = false;\r\n                  arcgisOnlineOption.allow = false;\r\n                } else {\r\n                  searchContext.arcgisOnlinePortal = arcgisOnlinePortal;\r\n                  //console.warn(\"searchContext.arcgisOnlinePortal\",arcgisOnlinePortal);\r\n                }\r\n                dfd.resolve();\r\n              }).otherwise(function(error) {\r\n                searchContext.allowArcGISOnline = false;\r\n                arcgisOnlineOption.allow = false;\r\n                console.warn(msg);\r\n                console.warn(error);\r\n                dfd.resolve();\r\n              });\r\n            }\r\n          }\r\n          //console.warn(\"arcgisOnlinePortal\",arcgisOnlinePortal);\r\n        } else {\r\n          if (!hasUsername && !portal.isPortal) {\r\n            // MyOrganization and ArcGISOnline are equivalent, - PUBLIC\r\n            if (scopeOptions.MyOrganization.allow && scopeOptions.ArcGISOnline.allow) {\r\n              scopeOptions.MyOrganization.allow = false;\r\n            }\r\n          }\r\n        }\r\n        if (bResolve) {\r\n          dfd.resolve();\r\n        }\r\n        return dfd;\r\n      },\r\n\r\n      _initFooter: function(parentNode, widgets) {\r\n        if(parentNode) {\r\n          var searchWidget = widgets.searchWidget,\r\n              hasSearchFooter = false;\r\n          if(searchWidget &&\r\n             searchWidget.footerNode &&\r\n             searchWidget.footerNode.nodeName) {\r\n            hasSearchFooter = true;\r\n          }\r\n          var footerContainer = this.footerContainer = document.createElement(\"DIV\");\r\n          footerContainer.className = this.baseClass + \"-footer\";\r\n          if(hasSearchFooter) {\r\n            footerContainer.appendChild(searchWidget.footerNode);\r\n          }\r\n          var layerListBtn = document.createElement(\"A\");\r\n          layerListBtn.className = \"layerlist-button jimu-float-trailing\";\r\n          layerListBtn.href = \"#\";\r\n          layerListBtn.innerHTML = \"<span class='esri-icon-layers'></span>\" + this.nls.layerList.caption;\r\n          this.own(on(layerListBtn, \"click\", lang.hitch(this, function(evt) {\r\n            evt.preventDefault();\r\n            this.showLayers();\r\n          })));\r\n          footerContainer.appendChild(layerListBtn);\r\n          var messageNode = this.messageNode = document.createElement(\"SPAN\");\r\n          messageNode.className = \"message\";\r\n          footerContainer.appendChild(messageNode);\r\n          var targetNode = parentNode.containerNode || parentNode.domNode || parentNode;\r\n          if(targetNode.nodeName) {\r\n            targetNode.appendChild(footerContainer);\r\n          }\r\n          this.own(on(this.tabContainer, \"tabChanged\", lang.hitch(this, function(title) {\r\n            this._setStatus(\"\");\r\n            if(hasSearchFooter) {\r\n              searchWidget.footerNode.style.display = title === this.nls.tabs.search ? \"\" : \"none\";\r\n            }\r\n            if(this.nls.tabs.search === title) {\r\n              if(hasSearchFooter) {\r\n                searchWidget.footerNode.style.display = \"\";\r\n              }\r\n              messageNode.style.display = \"none\";\r\n            } else {\r\n              if(hasSearchFooter) {\r\n                searchWidget.footerNode.style.display = \"none\";\r\n              }\r\n              messageNode.style.display = \"\";\r\n            }\r\n          })));\r\n        }\r\n      },\r\n\r\n      _initListeners: function() {\r\n        var self = this;\r\n        if (this.map) {\r\n          this.own(this.map.on(\"extent-change\", function() {\r\n            try {\r\n              if (self.searchPane && self.searchPane.bboxOption.bboxToggle.get(\"checked\")) {\r\n                if (self._isOpen) {\r\n                  self.searchPane.search();\r\n                } else {\r\n                  self._searchOnOpen = true;\r\n                }\r\n              }\r\n            } catch (ex) {\r\n              console.warn(ex);\r\n            }\r\n          }));\r\n        }\r\n      },\r\n\r\n      _initTabs: function(){\r\n        var config = this.config, tabs = [];\r\n        //console.warn(\"config\",config);\r\n\r\n        var supportsFile = !!(window.File && window.FileReader && window.FormData);\r\n        var allowSearch = false, options = config.scopeOptions;\r\n        var chkAllowSearch = function(name) {\r\n          if (!allowSearch) {\r\n            if (options && options[name] && options[name].allow) {\r\n              allowSearch = true;\r\n            }\r\n          }\r\n        };\r\n        chkAllowSearch(\"MyContent\");\r\n        chkAllowSearch(\"MyOrganization\");\r\n        chkAllowSearch(\"Curated\");\r\n        chkAllowSearch(\"ArcGISOnline\");\r\n\r\n        if (allowSearch) {\r\n          this.searchPane = new SearchPane({\r\n            wabWidget: this\r\n          },this.searchNode);\r\n          tabs.push({\r\n            title: this.nls.tabs.search,\r\n            content: this.searchPane.domNode\r\n          });\r\n        }\r\n        if (config.addFromUrl && config.addFromUrl.allow) {\r\n          this.addFromUrlPane = new AddFromUrlPane({\r\n            wabWidget: this\r\n          },this.urlNode);\r\n          tabs.push({\r\n            title: this.nls.tabs.url,\r\n            content: this.addFromUrlPane.domNode\r\n          });\r\n        }\r\n        if (supportsFile && config.addFromFile && config.addFromFile.allow) {\r\n          this.addFromFilePane = new AddFromFilePane({\r\n            wabWidget: this\r\n          },this.fileNode);\r\n          tabs.push({\r\n            title: this.nls.tabs.file,\r\n            content: this.addFromFilePane.domNode\r\n          });\r\n        }\r\n\r\n        var self = this;\r\n        if (tabs.length > 0) {\r\n          this.tabContainer = new TabContainer3({\r\n            average: true,\r\n            tabs: tabs\r\n          }, this.tabsNode);\r\n          try {\r\n            if (tabs.length === 1 && this.tabContainer.controlNode &&\r\n              this.tabContainer.containerNode) {\r\n              this.tabContainer.controlNode.style.display = \"none\";\r\n              this.tabContainer.containerNode.style.top = \"0px\";\r\n              //console.warn(\"this.tabContainer\",this.tabContainer);\r\n            }\r\n          } catch(ex1) {}\r\n          //this.tabContainer.hideShelter();\r\n          this.own(aspect.after(this.tabContainer,\"selectTab\",function(title){\r\n            //console.warn(\"selectTab\",title);\r\n            if (self.searchPane && title === self.nls.tabs.search) {\r\n              self.searchPane.resize();\r\n            }\r\n          },true));\r\n        } else if (tabs.length === 0) {\r\n          this.tabsNode.appendChild(document.createTextNode(this.nls.noOptionsConfigured));\r\n        }\r\n      },\r\n\r\n      _setStatus: function(msg) {\r\n        if (!this.messageNode) {\r\n          return;\r\n        }\r\n        util.setNodeText(this.messageNode, msg);\r\n        this.messageNode.title = msg;\r\n      },\r\n\r\n      onClose: function() {\r\n        this._isOpen = false;\r\n      },\r\n\r\n      onOpen: function() {\r\n        var bSearch = (this.searchPane && this._searchOnOpen);\r\n        this._isOpen = true;\r\n        this._searchOnOpen = false;\r\n        this.resize();\r\n        if (bSearch) {\r\n          this.searchPane.search();\r\n        }\r\n      },\r\n\r\n      resize: function() {\r\n        var widgetWidth = this.domNode.clientWidth,\r\n            widgetHeight = this.domNode.clientHeight;\r\n        if (widgetWidth > 1000) {\r\n          domClass.remove(this.domNode, \"width-768\");\r\n          domClass.add(this.domNode, \"width-1200\");\r\n        } else if (widgetWidth > 768) {\r\n          domClass.remove(this.domNode, \"width-1200\");\r\n          domClass.add(this.domNode, \"width-768\");\r\n        } else {\r\n          domClass.remove(this.domNode, [\"width-768\", \"width-1200\"]);\r\n        }\r\n\r\n        if (widgetWidth < 420) {\r\n          domClass.remove(this.domNode, \"width-medium\");\r\n          domClass.add(this.domNode, \"width-small\");\r\n        } else if (widgetWidth < 750) {\r\n          domClass.remove(this.domNode, \"width-small\");\r\n          domClass.add(this.domNode, \"width-medium\");\r\n        } else {\r\n          domClass.remove(this.domNode, [\"width-small\", \"width-medium\"]);\r\n        }\r\n\r\n        //console.warn(\"widgetWidth\",widgetWidth);\r\n        if (widgetWidth < 340) {\r\n          domClass.add(this.domNode,\"filter-placeholder-on\");\r\n        } else {\r\n          domClass.remove(this.domNode,\"filter-placeholder-on\");\r\n        }\r\n\r\n        if(widgetHeight < 400) {\r\n          domClass.add(this.domNode, \"height-small\");\r\n        } else {\r\n          domClass.remove(this.domNode, \"height-small\");\r\n        }\r\n\r\n        if (this.searchPane) {\r\n          this.searchPane.resize();\r\n        }\r\n      },\r\n\r\n      showLayers: function(){\r\n        if (!this.layerListPane) {\r\n          this.layerListPane = new LayerListPane({\r\n            wabWidget: this\r\n          });\r\n          this.layerListPane.placeAt(this.domNode);\r\n        }\r\n        this.layerListPane.show();\r\n      }\r\n    });\r\n\r\n  });\r\n"]}