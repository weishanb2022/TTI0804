{"version":3,"sources":["../../../../widgets/AddData/search/SortOptions.js"],"names":["define","declare","on","domClass","SearchComponent","template","i18n","templateString","sortField","sortOrder","postCreate","inherited","arguments","updateSortOrderButton","self","own","sortSelect","v","get","search","dropDown","selectPopup","domNode","parentElement","add","sortOrderClicked","btn","sortOrderBtn","length","style","visibility","remove","appendQueryParams","params","canSortByRelevance"],"mappings":"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","file":"SortOptions.js","sourcesContent":["///////////////////////////////////////////////////////////////////////////\r\n// Copyright Â© Esri. All Rights Reserved.\r\n//\r\n// Licensed under the Apache License Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//    http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n///////////////////////////////////////////////////////////////////////////\r\ndefine([\"dojo/_base/declare\",\r\n    \"dojo/on\",\r\n    \"dojo/dom-class\",\r\n    \"./SearchComponent\",\r\n    \"dojo/text!./templates/SortOptions.html\",\r\n    \"dojo/i18n!../nls/strings\",\r\n    \"dijit/form/Select\"\r\n  ],\r\n  function(declare, on, domClass, SearchComponent, template, i18n) {\r\n\r\n    return declare([SearchComponent], {\r\n\r\n      i18n: i18n,\r\n      templateString: template,\r\n\r\n      sortField: null,\r\n      sortOrder: null,\r\n\r\n      postCreate: function() {\r\n        this.inherited(arguments);\r\n        this.updateSortOrderButton();\r\n\r\n        var self = this;\r\n        this.own(this.sortSelect.on(\"change\", function() {\r\n          var v = self.sortField = self.sortSelect.get(\"value\");\r\n          if (v === \"\") {\r\n            self.sortOrder = null;\r\n          } else if (v === \"title\" || v === \"owner\") {\r\n            self.sortOrder = \"asc\";\r\n          } else if (v === \"avgrating\" || v === \"numviews\" || v === \"modified\") {\r\n            self.sortOrder = \"desc\";\r\n          }\r\n          self.updateSortOrderButton();\r\n          self.search();\r\n        }));\r\n\r\n        this.own(on(this.sortSelect.dropDown, \"open\", function(){\r\n          var selectPopup = this.domNode.parentElement;\r\n          if(selectPopup) {\r\n            domClass.add(selectPopup, \"add-data-widget-popup\");\r\n          }\r\n        }));\r\n      },\r\n\r\n      sortOrderClicked: function() {\r\n        if (this.sortOrder === \"asc\") {\r\n          this.sortOrder = \"desc\";\r\n          this.updateSortOrderButton();\r\n          this.search();\r\n        } else if (this.sortOrder === \"desc\") {\r\n          this.sortOrder = \"asc\";\r\n          this.updateSortOrderButton();\r\n          this.search();\r\n        }\r\n      },\r\n\r\n      updateSortOrderButton: function() {\r\n        var btn = this.sortOrderBtn;\r\n        if (this.sortField !== null && this.sortField.length > 0) {\r\n          btn.style.visibility = \"visible\";\r\n        } else {\r\n          btn.style.visibility = \"hidden\";\r\n        }\r\n        if (this.sortOrder === \"desc\") {\r\n          domClass.add(btn, \"descending\");\r\n        } else {\r\n          domClass.remove(btn, \"descending\");\r\n        }\r\n      },\r\n\r\n      /* SearchComponent API ============================================= */\r\n\r\n      appendQueryParams: function(params) {\r\n        params.sortField = null;\r\n        params.sortOrder = null;\r\n        var sortField = this.sortField,\r\n          sortOrder = this.sortOrder;\r\n        if (sortField !== null && sortField.length > 0) {\r\n          params.sortField = sortField;\r\n          if (sortOrder !== null && sortOrder.length > 0) {\r\n            params.sortOrder = sortOrder;\r\n          }\r\n        } else if (!params.canSortByRelevance) {\r\n          //params.sortField = \"title\";\r\n          //params.sortOrder = \"asc\";\r\n          params.sortField = \"numviews\";\r\n          params.sortOrder = \"desc\";\r\n        }\r\n      }\r\n\r\n    });\r\n\r\n  });\r\n"]}