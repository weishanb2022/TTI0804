{"version":3,"sources":["../../../../widgets/AddData/search/TypeOptions.js"],"names":["define","declare","array","lang","on","SearchComponent","template","i18n","VectorTileLayer","templateString","postCreate","inherited","arguments","supported","console","warn","vectorTileNode","style","display","own","tooltipDialog","hitch","v","searchPane","wabWidget","appConfig","theme","name","domNode","className","mapServiceToggle","search","featureServiceToggle","imageServiceToggle","vectorTileServiceToggle","kmlToggle","wmsToggle","wfsToggle","wmtsToggle","getOptionWidgets","optionClicked","appendQueryParams","params","appendQ","q","qToAppend","length","qAll","hasCheck","forEach","widget","dq","getAttribute","getValue"],"mappings":"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","file":"TypeOptions.js","sourcesContent":["///////////////////////////////////////////////////////////////////////////\r\n// Copyright Â© Esri. All Rights Reserved.\r\n//\r\n// Licensed under the Apache License Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//    http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n///////////////////////////////////////////////////////////////////////////\r\ndefine([\"dojo/_base/declare\",\r\n    \"dojo/_base/array\",\r\n    \"dojo/_base/lang\",\r\n    \"dojo/on\",\r\n    \"./SearchComponent\",\r\n    \"dojo/text!./templates/TypeOptions.html\",\r\n    \"dojo/i18n!../nls/strings\",\r\n    \"esri/layers/VectorTileLayer\",\r\n    \"dijit/TooltipDialog\",\r\n    \"dijit/form/DropDownButton\",\r\n    \"jimu/dijit/CheckBox\"\r\n  ],\r\n  function(declare, array, lang, on, SearchComponent, template, i18n,\r\n    VectorTileLayer) {\r\n\r\n    return declare([SearchComponent], {\r\n\r\n      i18n: i18n,\r\n      templateString: template,\r\n\r\n      postCreate: function() {\r\n        this.inherited(arguments);\r\n\r\n        if (!VectorTileLayer || !VectorTileLayer.supported()) {\r\n          console.warn(\"AddData: Vector Tile is not supported.\");\r\n          this.vectorTileNode.style.display = \"none\";\r\n        }\r\n\r\n        this.own(on(this.tooltipDialog, \"open\", lang.hitch(this, function() {\r\n          var v = this.searchPane.wabWidget.appConfig.theme.name;\r\n          this.tooltipDialog.domNode.className += \" \" + v;\r\n        })));\r\n\r\n        this.own(on(this.mapServiceToggle,'change',lang.hitch(this,function(){\r\n          this.search();\r\n        })));\r\n        this.own(on(this.featureServiceToggle,'change',lang.hitch(this,function(){\r\n          this.search();\r\n        })));\r\n        this.own(on(this.imageServiceToggle,'change',lang.hitch(this,function(){\r\n          this.search();\r\n        })));\r\n        this.own(on(this.vectorTileServiceToggle,'change',lang.hitch(this,function(){\r\n          this.search();\r\n        })));\r\n        this.own(on(this.kmlToggle,'change',lang.hitch(this,function(){\r\n          this.search();\r\n        })));\r\n        this.own(on(this.wmsToggle,'change',lang.hitch(this,function(){\r\n          this.search();\r\n        })));\r\n        this.own(on(this.wfsToggle,'change',lang.hitch(this,function(){\r\n          this.search();\r\n        })));\r\n        this.own(on(this.wmtsToggle,'change',lang.hitch(this,function(){\r\n          this.search();\r\n        })));\r\n      },\r\n\r\n      getOptionWidgets: function() {\r\n        return [\r\n          this.mapServiceToggle,\r\n          this.featureServiceToggle,\r\n          this.imageServiceToggle,\r\n          this.vectorTileServiceToggle,\r\n          this.kmlToggle,\r\n          this.wmsToggle,\r\n          this.wfsToggle,\r\n          this.wmtsToggle\r\n        ];\r\n      },\r\n\r\n      optionClicked: function() {\r\n        // was working for digit/form/CheckBox but it is not fored for jimu/dijit/CheckBox\r\n        //this.search();\r\n      },\r\n\r\n      /* SearchComponent API ============================================= */\r\n\r\n      appendQueryParams: function(params) {\r\n        var appendQ = function(q, qToAppend) {\r\n          if (q.length > 0) {\r\n            q += \" OR \";\r\n          }\r\n          return q + qToAppend;\r\n        };\r\n\r\n        var q = \"\",\r\n          qAll = \"\",\r\n          hasCheck = false;\r\n        array.forEach(this.getOptionWidgets(), function(widget) {\r\n          var dq = widget.domNode.getAttribute(\"data-option-q\");\r\n          qAll = appendQ(qAll, dq);\r\n          if (widget.getValue()) {\r\n            q = appendQ(q, dq);\r\n            hasCheck = true;\r\n          }\r\n        });\r\n        if (!hasCheck) {\r\n          q = qAll;\r\n        }\r\n        if (q !== null && q.length > 0) {\r\n          q = \"(\" + q + \")\";\r\n          if (params.q !== null && params.q.length > 0) {\r\n            params.q += \" AND \" + q;\r\n          } else {\r\n            params.q = q;\r\n          }\r\n        }\r\n      }\r\n\r\n    });\r\n  });\r\n"]}