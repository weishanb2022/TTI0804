{"version":3,"sources":["../../../../widgets/AddData/search/Paging.js"],"names":["define","declare","domClass","SearchComponent","template","i18n","util","templateString","hasLess","hasMore","nextStart","numPerPage","previousStart","start","postCreate","inherited","arguments","enableOrDisable","startup","_started","numPer","getConfig","v","Number","isNaN","Math","floor","ex","console","warn","remove","firstButton","parentNode","previousButton","add","nextButton","firstButtonClicked","search","previousButtonClicked","nextButtonClicked","appendQueryParams","params","num","processResults","searchResponse","nPer","nHits","total","nStart","queryParams","nextQueryParams","sPage","nPage","paging","pagePattern","replace","setNodeText","pageNode"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAA,OAAO,CAAC,oBAAD,EACH,gBADG,EAEH,mBAFG,EAGH,mCAHG,EAIH,0BAJG,EAKH,QALG,CAAP,EAOE,UAASC,OAAT,EAAkBC,QAAlB,EAA4BC,eAA5B,EAA6CC,QAA7C,EAAuDC,IAAvD,EAA6DC,IAA7D,EAAmE;;AAEjE,SAAOL,QAAQ,CAACE,eAAD,CAAR,EAA2B;;AAEhCE,UAAMA,IAF0B;AAGhCE,oBAAgBH,QAHgB;;AAKhCI,aAAS,KALuB;AAMhCC,aAAS,KANuB;AAOhCC,eAAW,CAAC,CAPoB;AAQhCC,gBAAY,IARoB;AAShCC,mBAAe,CAAC,CATgB;AAUhCC,WAAO,CAVyB;;AAYhCC,gBAAY,sBAAW;AACrB,WAAKC,SAAL,CAAeC,SAAf;AACA,UAAI,KAAKL,UAAL,KAAoB,IAAxB,EAA8B;AAC5B,aAAKA,UAAL,GAAkB,EAAlB;AACD;AACD,WAAKM,eAAL;AACD,KAlB+B;;AAoBhCC,aAAS,mBAAW;AAClB,UAAI,KAAKC,QAAT,EAAmB;AACjB;AACD;AACD,WAAKJ,SAAL,CAAeC,SAAf;;AAEA,UAAI;AACF,YAAII,SAAS,KAAKC,SAAL,GAAiBV,UAA9B;AACA,YAAIW,IAAIC,OAAOH,MAAP,CAAR;AACA,YAAI,OAAOE,CAAP,KAAa,QAAb,IAAyB,CAACE,MAAMF,CAAN,CAA9B,EAAwC;AACtCA,cAAIG,KAAKC,KAAL,CAAWJ,CAAX,CAAJ;AACA,cAAIA,KAAK,CAAL,IAAUA,KAAK,GAAnB,EAAwB;AACtB,iBAAKX,UAAL,GAAkBW,CAAlB;AACD;AACF;AACF,OATD,CASE,OAAOK,EAAP,EAAW;AACXC,gBAAQC,IAAR,CAAa,2BAAb;AACAD,gBAAQC,IAAR,CAAaF,EAAb;AACD;AACD,UAAI,KAAKhB,UAAL,KAAoB,IAAxB,EAA8B;AAC5B,aAAKA,UAAL,GAAkB,EAAlB;AACD;AACF,KA1C+B;;AA4ChCM,qBAAiB,2BAAW;AAC1B,UAAI,KAAKT,OAAT,EAAkB;AAChBN,iBAAS4B,MAAT,CAAgB,KAAKC,WAAL,CAAiBC,UAAjC,EAA6C,UAA7C;AACA9B,iBAAS4B,MAAT,CAAgB,KAAKG,cAAL,CAAoBD,UAApC,EAAgD,UAAhD;AACD,OAHD,MAGO;AACL9B,iBAASgC,GAAT,CAAa,KAAKH,WAAL,CAAiBC,UAA9B,EAA0C,UAA1C;AACA9B,iBAASgC,GAAT,CAAa,KAAKD,cAAL,CAAoBD,UAAjC,EAA6C,UAA7C;AACD;AACD,UAAI,KAAKvB,OAAT,EAAkB;AAChBP,iBAAS4B,MAAT,CAAgB,KAAKK,UAAL,CAAgBH,UAAhC,EAA4C,UAA5C;AACD,OAFD,MAEO;AACL9B,iBAASgC,GAAT,CAAa,KAAKC,UAAL,CAAgBH,UAA7B,EAAyC,UAAzC;AACD;AACF,KAzD+B;;AA2DhC;;AAEAI,wBAAoB,8BAAW;AAC7B,UAAI,KAAK5B,OAAT,EAAkB;AAChB,aAAKK,KAAL,GAAa,CAAb;AACA,aAAKwB,MAAL;AACD;AACF,KAlE+B;AAmEhCC,2BAAuB,iCAAW;AAChC,UAAI,KAAK9B,OAAT,EAAkB;AAChB,aAAKK,KAAL,GAAa,KAAKD,aAAlB;AACA,aAAKyB,MAAL;AACD;AACF,KAxE+B;AAyEhCE,uBAAmB,6BAAW;AAC5B,UAAI,KAAK9B,OAAT,EAAkB;AAChB,aAAKI,KAAL,GAAa,KAAKH,SAAlB;AACA,aAAK2B,MAAL;AACD;AACF,KA9E+B;;AAgFhC;;AAEAG,uBAAmB,2BAASC,MAAT,EAAiB;AAClCA,aAAO5B,KAAP,GAAe,KAAKA,KAApB;AACA4B,aAAOC,GAAP,GAAa,KAAK/B,UAAlB;AACD,KArF+B;;AAuFhCgC,oBAAgB,wBAASC,cAAT,EAAyB;AACvC,WAAK/B,KAAL,GAAa,CAAb;AACA,UAAIgC,OAAO,KAAKlC,UAAhB;AACA,UAAImC,QAAQF,eAAeG,KAA3B;AACA,UAAIC,SAASJ,eAAeK,WAAf,CAA2BpC,KAAxC;AACA,UAAImC,SAAS,CAAb,EAAgB;AACdA,iBAAS,CAAT;AACD;;AAED,WAAKxC,OAAL,GAAe,KAAf;AACA,WAAKI,aAAL,GAAqB,CAAC,CAAtB;AACA,UAAIoC,SAAS,CAAb,EAAgB;AACd,aAAKxC,OAAL,GAAe,IAAf;AACA,aAAKI,aAAL,GAAqBoC,SAASJ,eAAeK,WAAf,CAA2BP,GAAzD;AACA,YAAI,KAAK9B,aAAL,GAAqB,CAAzB,EAA4B;AAC1B,eAAKA,aAAL,GAAqB,CAArB;AACD;AACF;;AAED,WAAKH,OAAL,GAAe,KAAf;AACA,WAAKC,SAAL,GAAiB,CAAC,CAAlB;AACA,UAAIkC,eAAeM,eAAf,IAAkCN,eAAeM,eAAf,CAA+BrC,KAA/B,GAAuC,CAA7E,EAAgF;AAC9E,aAAKJ,OAAL,GAAe,IAAf;AACA,aAAKC,SAAL,GAAiBkC,eAAeM,eAAf,CAA+BrC,KAAhD;AACD;;AAED,UAAIsC,QAAQ,EAAZ;AACA,UAAIL,QAAQD,IAAZ,EAAkB;AAChB,YAAIO,QAAQ,CAAZ;AACA,YAAIJ,SAAS,CAAb,EAAgB;AACdI,kBAAQ3B,KAAKC,KAAL,CAAWsB,SAASH,IAApB,IAA4B,CAApC;AACD;AACDM,gBAAQ,KAAK9C,IAAL,CAAUgC,MAAV,CAAiBgB,MAAjB,CAAwBC,WAAhC;AACAH,gBAAQA,MAAMI,OAAN,CAAc,QAAd,EAAwB,KAAKH,KAA7B,CAAR;AACD,OAPD,MAOO;AACLD,gBAAQ,KAAK9C,IAAL,CAAUgC,MAAV,CAAiBgB,MAAjB,CAAwBC,WAAhC;AACAH,gBAAQA,MAAMI,OAAN,CAAc,QAAd,EAAwB,KAAK,CAA7B,CAAR;AACD;AACDjD,WAAKkD,WAAL,CAAiB,KAAKC,QAAtB,EAAgCN,KAAhC;AACA,WAAKlC,eAAL;AACD;;AA/H+B,GAA3B,CAAP;AAkID,CA3IH","file":"Paging.js","sourcesContent":["///////////////////////////////////////////////////////////////////////////\r\n// Copyright Â© Esri. All Rights Reserved.\r\n//\r\n// Licensed under the Apache License Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//    http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n///////////////////////////////////////////////////////////////////////////\r\ndefine([\"dojo/_base/declare\",\r\n    \"dojo/dom-class\",\r\n    \"./SearchComponent\",\r\n    \"dojo/text!./templates/Paging.html\",\r\n    \"dojo/i18n!../nls/strings\",\r\n    \"./util\"\r\n  ],\r\n  function(declare, domClass, SearchComponent, template, i18n, util) {\r\n\r\n    return declare([SearchComponent], {\r\n\r\n      i18n: i18n,\r\n      templateString: template,\r\n\r\n      hasLess: false,\r\n      hasMore: false,\r\n      nextStart: -1,\r\n      numPerPage: null,\r\n      previousStart: -1,\r\n      start: 1,\r\n\r\n      postCreate: function() {\r\n        this.inherited(arguments);\r\n        if (this.numPerPage === null) {\r\n          this.numPerPage = 30;\r\n        }\r\n        this.enableOrDisable();\r\n      },\r\n\r\n      startup: function() {\r\n        if (this._started) {\r\n          return;\r\n        }\r\n        this.inherited(arguments);\r\n\r\n        try {\r\n          var numPer = this.getConfig().numPerPage;\r\n          var v = Number(numPer);\r\n          if (typeof v === \"number\" && !isNaN(v)) {\r\n            v = Math.floor(v);\r\n            if (v >= 1 && v <= 100) {\r\n              this.numPerPage = v;\r\n            }\r\n          }\r\n        } catch (ex) {\r\n          console.warn(\"Error setting numPerPage:\");\r\n          console.warn(ex);\r\n        }\r\n        if (this.numPerPage === null) {\r\n          this.numPerPage = 30;\r\n        }\r\n      },\r\n\r\n      enableOrDisable: function() {\r\n        if (this.hasLess) {\r\n          domClass.remove(this.firstButton.parentNode, \"disabled\");\r\n          domClass.remove(this.previousButton.parentNode, \"disabled\");\r\n        } else {\r\n          domClass.add(this.firstButton.parentNode, \"disabled\");\r\n          domClass.add(this.previousButton.parentNode, \"disabled\");\r\n        }\r\n        if (this.hasMore) {\r\n          domClass.remove(this.nextButton.parentNode, \"disabled\");\r\n        } else {\r\n          domClass.add(this.nextButton.parentNode, \"disabled\");\r\n        }\r\n      },\r\n\r\n      /* events ========================================================== */\r\n\r\n      firstButtonClicked: function() {\r\n        if (this.hasLess) {\r\n          this.start = 1;\r\n          this.search();\r\n        }\r\n      },\r\n      previousButtonClicked: function() {\r\n        if (this.hasLess) {\r\n          this.start = this.previousStart;\r\n          this.search();\r\n        }\r\n      },\r\n      nextButtonClicked: function() {\r\n        if (this.hasMore) {\r\n          this.start = this.nextStart;\r\n          this.search();\r\n        }\r\n      },\r\n\r\n      /* SearchComponent API ============================================= */\r\n\r\n      appendQueryParams: function(params) {\r\n        params.start = this.start;\r\n        params.num = this.numPerPage;\r\n      },\r\n\r\n      processResults: function(searchResponse) {\r\n        this.start = 1;\r\n        var nPer = this.numPerPage;\r\n        var nHits = searchResponse.total;\r\n        var nStart = searchResponse.queryParams.start;\r\n        if (nStart < 1) {\r\n          nStart = 1;\r\n        }\r\n\r\n        this.hasLess = false;\r\n        this.previousStart = -1;\r\n        if (nStart > 1) {\r\n          this.hasLess = true;\r\n          this.previousStart = nStart - searchResponse.queryParams.num;\r\n          if (this.previousStart < 1) {\r\n            this.previousStart = 1;\r\n          }\r\n        }\r\n\r\n        this.hasMore = false;\r\n        this.nextStart = -1;\r\n        if (searchResponse.nextQueryParams && searchResponse.nextQueryParams.start > 1) {\r\n          this.hasMore = true;\r\n          this.nextStart = searchResponse.nextQueryParams.start;\r\n        }\r\n\r\n        var sPage = \"\";\r\n        if (nHits > nPer) {\r\n          var nPage = 1;\r\n          if (nStart > 1) {\r\n            nPage = Math.floor(nStart / nPer) + 1;\r\n          }\r\n          sPage = this.i18n.search.paging.pagePattern;\r\n          sPage = sPage.replace(\"{page}\", \"\" + nPage);\r\n        } else {\r\n          sPage = this.i18n.search.paging.pagePattern;\r\n          sPage = sPage.replace(\"{page}\", \"\" + 1);\r\n        }\r\n        util.setNodeText(this.pageNode, sPage);\r\n        this.enableOrDisable();\r\n      }\r\n\r\n    });\r\n  });\r\n"]}