{"version":3,"sources":["../../../../widgets/Analysis/setting/SingleToolSetting.js"],"names":["define","declare","template","domStyle","_WidgetBase","_TemplatedMixin","_WidgetsInTemplateMixin","portalUrlUtils","CheckBox","baseClass","templateString","toolLabel","nls","config","rowData","livingAtlasConfigEnabled","postCreate","inherited","arguments","labelEditor","set","title","resultOption","showOutputTypeOption","helptipChk","checked","label","showHelpTip","placeAt","helpTipOption","mapExtentChk","showCurrentMapExtent","mapExtentOption","creditsChk","showCredits","creditsOption","resultChk","saveAsFeatureService","readyToUseLayersChk","showReadyToUseLayers","readyToUseLayersOption","allowToExportChk","allowToExport","allowToExportOption","showOutputTypeChk","includeRouteLayer","portalUrl","getStandardPortalUrl","appConfig","isOnline","indexOf","setValue","getConfig","ret","showHelp","getValue","showChooseExtent","returnFeatureCollection","showOutputType","validate","newLabel","get","setConfig","Boolean"],"mappings":"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","file":"SingleToolSetting.js","sourcesContent":["///////////////////////////////////////////////////////////////////////////\r\n// Copyright Â© Esri. All Rights Reserved.\r\n//\r\n// Licensed under the Apache License Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//    http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n///////////////////////////////////////////////////////////////////////////\r\n/**\r\n * Single Analysis tool setting section.\r\n * @module widgets/Analysis/setting/SingleToolSetting\r\n */\r\ndefine(['dojo/_base/declare',\r\n  'dojo/text!./SingleToolSetting.html',\r\n  'dojo/dom-style',\r\n  'dijit/_WidgetBase',\r\n  'dijit/_TemplatedMixin',\r\n  'dijit/_WidgetsInTemplateMixin',\r\n  'jimu/portalUrlUtils',\r\n  'jimu/dijit/CheckBox',\r\n  'dijit/form/ValidationTextBox'\r\n  ], function(declare, template, domStyle, _WidgetBase, _TemplatedMixin, _WidgetsInTemplateMixin,\r\n  portalUrlUtils, CheckBox){\r\n  return /** @alias module: widgets/Analysis/setting/SingleToolSetting*/ declare([_WidgetBase,\r\n      _TemplatedMixin, _WidgetsInTemplateMixin], {\r\n    baseClass: 'jimu-widget-analysis-singleToolSetting',\r\n    templateString: template,\r\n\r\n    toolLabel: null,\r\n    nls: null,\r\n    /**\r\n     * Analysis tool config. Include these options:\r\n     * {\r\n     *   toolLabel: '',\r\n     *   showHelp: true,\r\n     *   showChooseExtent: true,\r\n     *   showCredits: true,\r\n     *   returnFeatureCollection: true //If tool is Extract Data, this option will be removed.\r\n     * }\r\n     * @type {[type]}\r\n     */\r\n    config: null,\r\n    /**\r\n     * Analysis tool settings. Include dijitID, analysisLayer, etc.\r\n     * @type {object}\r\n     */\r\n    rowData: null,\r\n\r\n    livingAtlasConfigEnabled: false,\r\n\r\n    postCreate: function(){\r\n      this.inherited(arguments);\r\n\r\n      this.labelEditor.set('value', this.toolLabel);\r\n\r\n      if(this.rowData.title === 'extractData'){\r\n        domStyle.set(this.resultOption, 'display', 'none');\r\n      }\r\n\r\n      if(this.rowData.title !== 'planRoutes' && this.rowData.title !== 'findNearest' &&\r\n        this.rowData.title !== 'connectOriginsToDestinations'){\r\n        domStyle.set(this.showOutputTypeOption, 'display', 'none');\r\n      }\r\n\r\n      this.helptipChk = new CheckBox({\r\n        checked:true,\r\n        label: this.nls.showHelpTip\r\n      });\r\n      this.helptipChk.placeAt(this.helpTipOption);\r\n\r\n      this.mapExtentChk = new CheckBox({\r\n        checked: true,\r\n        label: this.nls.showCurrentMapExtent\r\n      });\r\n      this.mapExtentChk.placeAt(this.mapExtentOption);\r\n\r\n      this.creditsChk = new CheckBox({\r\n        checked: true,\r\n        label: this.nls.showCredits\r\n      });\r\n      this.creditsChk.placeAt(this.creditsOption);\r\n\r\n      this.resultChk = new CheckBox({\r\n        checked: true,\r\n        label: this.nls.saveAsFeatureService\r\n      });\r\n      this.resultChk.placeAt(this.resultOption);\r\n\r\n      if (this.livingAtlasConfigEnabled) {\r\n        this.readyToUseLayersChk = new CheckBox({\r\n          checked: true,\r\n          label: this.nls.showReadyToUseLayers\r\n        });\r\n        this.readyToUseLayersChk.placeAt(this.readyToUseLayersOption);\r\n        domStyle.set(this.readyToUseLayersOption, 'display', 'block');\r\n      } else {\r\n        domStyle.set(this.readyToUseLayersOption, 'display', 'none');\r\n      }\r\n\r\n      this.allowToExportChk = new CheckBox({\r\n        checked: false,\r\n        label: this.nls.allowToExport\r\n      });\r\n      this.allowToExportChk.placeAt(this.allowToExportOption);\r\n\r\n      this.showOutputTypeChk = new CheckBox({\r\n        checked: false,\r\n        label: this.nls.includeRouteLayer\r\n      });\r\n      this.showOutputTypeChk.placeAt(this.showOutputTypeOption);\r\n\r\n      //Living Atlas Analysis Layer is not available in portal 10.4. Hide this option.\r\n      var portalUrl = portalUrlUtils.getStandardPortalUrl(this.appConfig.portalUrl);\r\n      if(!portalUrlUtils.isOnline(portalUrl) ||\r\n        ['createViewshed', 'createWatershed', 'traceDownstream'].indexOf(this.rowData.title) >= 0){\r\n        //Credits is not available in portal\r\n        domStyle.set(this.creditsOption, 'display', 'none');\r\n        this.creditsChk.setValue(false);\r\n      }\r\n\r\n      if(this.rowData.title === 'geocodeLocations'){\r\n        domStyle.set(this.mapExtentOption, 'display', 'none');\r\n        this.mapExtentChk.setValue(false);\r\n        domStyle.set(this.resultOption, 'display', 'none');\r\n        this.resultChk.setValue(false);\r\n      }\r\n    },\r\n\r\n    getConfig: function(){\r\n      var ret = {\r\n        showHelp: this.helptipChk.getValue(),\r\n        showCredits: this.creditsChk.getValue(),\r\n        showChooseExtent: this.mapExtentChk.getValue(),\r\n        showReadyToUseLayers: this.livingAtlasConfigEnabled ? this.readyToUseLayersChk.getValue() : false,\r\n        allowToExport: this.allowToExportChk.getValue()\r\n      };\r\n\r\n      if(this.rowData.title !== 'extractData'){\r\n        ret.returnFeatureCollection = !this.resultChk.getValue();\r\n      }\r\n      if(this.rowData.title === 'planRoutes' || this.rowData.title === 'findNearest' ||\r\n        this.rowData.title === 'connectOriginsToDestinations'){\r\n        ret.showOutputType = this.showOutputTypeChk.getValue();\r\n      }\r\n\r\n      if(this.labelEditor.validate()){\r\n        var newLabel = this.labelEditor.get('value');\r\n        // Save the label in config only if it is different from the default tool name\r\n        if (newLabel !== this.toolLabel) {\r\n          ret.toolLabel = newLabel;\r\n        }\r\n      }\r\n\r\n      return ret;\r\n    },\r\n\r\n    setConfig: function(config){\r\n      this.config = config;\r\n\r\n      if (config.toolLabel) {\r\n        this.labelEditor.set('value', config.toolLabel);\r\n      }\r\n      this.helptipChk.setValue(Boolean(config.showHelp));\r\n      this.creditsChk.setValue(Boolean(config.showCredits));\r\n      this.mapExtentChk.setValue(Boolean(config.showChooseExtent));\r\n      if (this.livingAtlasConfigEnabled) {\r\n        this.readyToUseLayersChk.setValue(Boolean(config.showReadyToUseLayers));\r\n      }\r\n      this.allowToExportChk.setValue(Boolean(config.allowToExport));\r\n\r\n      if('returnFeatureCollection' in config){\r\n        this.resultChk.setValue(!Boolean(config.returnFeatureCollection));\r\n      }\r\n\r\n      if('showOutputType' in config) {\r\n        this.showOutputTypeChk.setValue(Boolean(config.showOutputType));\r\n      }\r\n    }\r\n  });\r\n});\r\n"]}