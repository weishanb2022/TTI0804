{"version":3,"sources":["../../../../../themes/DashboardTheme/widgets/Header/Widget.js"],"names":["define","declare","lang","array","html","Color","query","on","keys","mouse","domConstruct","domGeometry","BaseWidget","tokenUtils","portalUtils","portalUrlUtils","utils","Message","clazz","baseClass","switchableElements","height","moveTopOnActive","postMixInProperties","inherited","arguments","isRenderIdForAttrs","postCreate","title","titleNode","links","linksNode","subtitle","subtitleNode","position","_handleTitleColorAndLogoLink","appConfig","setStyle","signInSectionNode","config","mode","color","domNode","toHex","portal","getPortal","portalUrl","loadSelfInfo","then","hitch","selfInfo","portalProperties","sharedTheme","header","background","err","console","error","mainBackgroundColor","getObject","logo","logoIconNode","src","removeClass","logoNode","addClass","innerHTML","sanitizeHTML","_createDynamicLinks","own","enter","server","getServerByUrl","isArcGIScom","nls","signInTo","signinLinkNode","startup","resize","onAction","action","data","node","widgetId","_highLight","_removeHighLight","onSignIn","credential","userNameLinkNode","signoutLinkNode","userId","setAttr","popupLinkNode","popupSigninNode","popupUserNameNode","popupSignoutNode","attr","onSignOut","_onSignOut","signin","name","signInTip","headerNodeFloat","getStyle","headerNode","logoNodeFloat","titlesNodeFloat","titlesNode","linksNodeFloat","allHasFloatStyle","_resize","setTimeout","_showSwitchableElements","destroy","timeoutHandle","clearTimeout","onAppConfigChanged","reason","changedData","_onAttributeChange","_onLogoLoad","hlDiv","getMarginBox","hlStyle","left","l","top","t","width","w","h","create","removeAttr","titleColor","themesHeaderLogoA11y","tabIndex","link","logoLinkNode","icon","empty","dynamicLinksNode","forEach","href","url","target","rel","label","window","jimuNls","common","opensInNewWindow","showElement","logoClickHandle","remove","logoKeydownHandle","indexOf","_onLogoClick","_onLogoKeydown","cursor","_switchSignin","getPortalCredential","_createPopupLinkNode","popupLinksVisible","_hidePopupLink","_showPopupLink","evt","keyCode","ENTER","isRTL","jimuConfig","layoutId","right","getContentBox","box","mainPageId","style","zIndex","bottom","folderUrl","marginTop","textNode","lineHeight","titleWidth","getMarginExtents","_createLinkNode","containerNode","isSign","lineNode","linkSectionNode","className","place","_onSigninClick","signInPortal","appId","_onSignoutClick","isDepolyedApp","signOutAll","message","cantSignOutTip","_onUserNameClick"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAA,OAAO,CACH,oBADG,EAEH,iBAFG,EAGH,kBAHG,EAIH,iBAJG,EAKH,kBALG,EAMH,YANG,EAOH,SAPG,EAQH,WARG,EASH,YATG,EAUH,oBAVG,EAWH,mBAXG,EAYH,iBAZG,EAaH,iBAbG,EAcH,kBAdG,EAeH,qBAfG,EAgBH,YAhBG,EAiBH,oBAjBG,CAAP,EAmBE,UAASC,OAAT,EAAkBC,IAAlB,EAAwBC,KAAxB,EAA+BC,IAA/B,EAAqCC,KAArC,EAA4CC,KAA5C,EAAmDC,EAAnD,EAAuDC,IAAvD,EAA6DC,KAA7D,EACEC,YADF,EACgBC,WADhB,EAC6BC,UAD7B,EACyCC,UADzC,EACqDC,WADrD,EAEEC,cAFF,EAEkBC,KAFlB,EAEyBC,OAFzB,EAEkC;AAChC;AACA;AACA,MAAIC,QAAQjB,QAAQ,CAACW,UAAD,CAAR,EAAsB;;AAEhCO,eAAW,wBAFqB;;AAIhC;AACAC,wBAAoB,EALY;;AAOhC;AACAC,YAAQ,EARwB;;AAUhCC,qBAAiB,KAVe;;AAYhCC,yBAAqB,+BAAW;AAC9B,WAAKC,SAAL,CAAeC,SAAf;AACA,WAAKC,kBAAL,GAA0B,IAA1B;AACD,KAf+B;;AAiBhCC,gBAAY,sBAAW;AACrB,WAAKH,SAAL,CAAeC,SAAf;;AAEA,WAAKL,kBAAL,CAAwBQ,KAAxB,GAAgC,KAAKC,SAArC;AACA,WAAKT,kBAAL,CAAwBU,KAAxB,GAAgC,KAAKC,SAArC;AACA,WAAKX,kBAAL,CAAwBY,QAAxB,GAAmC,KAAKC,YAAxC;;AAEA,UAAI,KAAKC,QAAL,IAAiB,KAAKA,QAAL,CAAcb,MAAnC,EAA2C;AACzC,aAAKA,MAAL,GAAc,KAAKa,QAAL,CAAcb,MAA5B;AACD;;AAED,WAAKc,4BAAL,CAAkC,KAAKC,SAAvC;;AAEA;AACAhC,WAAKiC,QAAL,CAAc,KAAKC,iBAAnB,EAAsC,SAAtC,EAAiD,MAAjD;AACA;AACA;AACA;AACA,UAAI,KAAKC,MAAL,IAAe,KAAKA,MAAL,CAAYC,IAAZ,KAAqB,QAApC,IAAgD,KAAKD,MAAL,CAAYE,KAAhE,EAAuE;AACrE,YAAIA,QAAQ,IAAIpC,KAAJ,CAAU,KAAKkC,MAAL,CAAYE,KAAtB,CAAZ;AACArC,aAAKiC,QAAL,CAAc,KAAKK,OAAnB,EAA4B,YAA5B,EAA0CD,MAAME,KAAN,EAA1C;AACD,OAHD,MAGO,IAAI,KAAKJ,MAAL,IAAe,KAAKA,MAAL,CAAYC,IAAZ,KAAqB,KAAxC,EAA+C;AACpD;AACA,YAAII,SAAS9B,YAAY+B,SAAZ,CAAsB,KAAKT,SAAL,CAAeU,SAArC,CAAb;AACAF,eAAOG,YAAP,GAAsBC,IAAtB,CAA2B9C,KAAK+C,KAAL,CAAW,IAAX,EAAiB,UAAUC,QAAV,EAAoB;AAC9D,cAAIA,YAAYA,SAASC,gBAArB,IAAyCD,SAASC,gBAAT,CAA0BC,WAAnE,IACFF,SAASC,gBAAT,CAA0BC,WAA1B,CAAsCC,MADxC,EACgD;AAC9CjD,iBAAKiC,QAAL,CAAc,KAAKK,OAAnB,EAA4B,YAA5B,EAA0CQ,SAASC,gBAAT,CAA0BC,WAA1B,CAAsCC,MAAtC,CAA6CC,UAAvF;AACD;AACF,SAL0B,CAA3B,EAKIpD,KAAK+C,KAAL,CAAW,IAAX,EAAiB,UAAUM,GAAV,EAAe;AAClCC,kBAAQC,KAAR,CAAcF,GAAd;AACD,SAFG,CALJ;AAQD,OAXM,MAWA,IAAI,KAAKhB,MAAL,IAAe,KAAKA,MAAL,CAAYC,IAAZ,KAAqB,OAAxC,EAAiD;AACtD;AACApC,aAAKiC,QAAL,CAAc,KAAKK,OAAnB,EAA4B,YAA5B,EAA0C,IAA1C;AACD,OAHM,MAGA;AACL;AACA,YAAIgB,sBAAsBxD,KAAKyD,SAAL,CAAe,wCAAf,EAAyD,KAAzD,EAAgE,KAAKvB,SAArE,CAA1B;AACA,YAAIsB,mBAAJ,EAAyB;AACvBtD,eAAKiC,QAAL,CAAc,KAAKK,OAAnB,EAA4B,YAA5B,EAA0CgB,mBAA1C;AACD;AACF;;AAED,UAAI,KAAKtB,SAAL,IAAkB,KAAKA,SAAL,CAAewB,IAArC,EAA2C;AACzC,aAAKC,YAAL,CAAkBC,GAAlB,GAAwB,KAAK1B,SAAL,CAAewB,IAAvC;AACAxD,aAAK2D,WAAL,CAAiB,KAAKC,QAAtB,EAAgC,QAAhC;AACD,OAHD,MAGO;AACL,aAAKH,YAAL,CAAkBC,GAAlB,GAAwB,EAAxB;AACA1D,aAAK6D,QAAL,CAAc,KAAKD,QAAnB,EAA6B,QAA7B;AACD;;AAED,WAAK5C,kBAAL,CAAwBQ,KAAxB,CAA8BsC,SAA9B,GACElD,MAAMmD,YAAN,CAAmB,KAAK/B,SAAL,CAAeR,KAAf,GAAuB,KAAKQ,SAAL,CAAeR,KAAtC,GAA8C,EAAjE,CADF;AAEA,WAAKR,kBAAL,CAAwBY,QAAxB,CAAiCkC,SAAjC,GACElD,MAAMmD,YAAN,CAAmB,KAAK/B,SAAL,CAAeJ,QAAf,GAA0B,KAAKI,SAAL,CAAeJ,QAAzC,GAAoD,EAAvE,CADF;;AAGA,WAAKoC,mBAAL,CAAyB,KAAKhC,SAAL,CAAeN,KAAxC;;AAEA,WAAKuC,GAAL,CAAS9D,GAAG,KAAKmC,OAAR,EAAiBjC,MAAM6D,KAAvB,EAA8BpE,KAAK+C,KAAL,CAAW,IAAX,EAAiB,YAAW;AACjE,YAAIrB,QAAQ,EAAZ;AACA,YAAIkB,YAAY,KAAKV,SAAL,IAAkB,KAAKA,SAAL,CAAeU,SAAjC,IAA8C,EAA9D;AACA,YAAIyB,SAASxD,eAAeyD,cAAf,CAA8B1B,SAA9B,CAAb;AACA,YAAI/B,eAAe0D,WAAf,CAA2BF,MAA3B,CAAJ,EAAwC;AACtCA,mBAAS,YAAT;AACD;AACD,YAAIA,MAAJ,EAAY;AACV3C,kBAAQ,KAAK8C,GAAL,CAASC,QAAT,GAAoB,GAApB,GAA0BJ,MAAlC;AACD;AACD,aAAKK,cAAL,CAAoBhD,KAApB,GAA4BA,KAA5B;AACD,OAXsC,CAA9B,CAAT;AAYD,KAvF+B;;AAyFhCiD,aAAS,mBAAW;AAClB,WAAKrD,SAAL,CAAeC,SAAf;AACA,WAAKqD,MAAL;AACA;AACD,KA7F+B;;AA+FhCC,cAAU,kBAASC,MAAT,EAAiBC,IAAjB,EAAuB;AAC/B;AACA,UAAID,WAAW,WAAX,IAA0BC,IAA9B,EAAoC;AAClC,YAAIC,OAAO5E,MAAM,oBAAoB2E,KAAKE,QAAzB,GAAoC,IAA1C,EAAgD,KAAKzC,OAArD,EAA8D,CAA9D,CAAX;AACA,aAAK0C,UAAL,CAAgBF,IAAhB;AACD;AACD,UAAIF,WAAW,iBAAf,EAAkC;AAChC,aAAKK,gBAAL;AACD;AACF,KAxG+B;;AA0GhCC,cAAU,kBAASC,UAAT,EAAqB;AAC7B,WAAK/D,SAAL,CAAeC,SAAf;;AAEArB,WAAKiC,QAAL,CAAc,KAAKuC,cAAnB,EAAmC,SAAnC,EAA8C,MAA9C;AACAxE,WAAKiC,QAAL,CAAc,KAAKmD,gBAAnB,EAAqC,SAArC,EAAgD,EAAhD;AACApF,WAAKiC,QAAL,CAAc,KAAKoD,eAAnB,EAAoC,SAApC,EAA+C,EAA/C;;AAEA,WAAKD,gBAAL,CAAsBtB,SAAtB,GAAkCqB,WAAWG,MAA7C;AACAtF,WAAKuF,OAAL,CAAa,KAAKH,gBAAlB,EAAoC,MAApC,EAA4C,KAAKpD,SAAL,CAAeU,SAAf,GAA2B,gBAAvE;;AAEA;AACA,UAAI,KAAK8C,aAAT,EAAwB;AACtBxF,aAAKiC,QAAL,CAAc,KAAKwD,eAAnB,EAAoC,SAApC,EAA+C,MAA/C;AACAzF,aAAKiC,QAAL,CAAc,KAAKyD,iBAAnB,EAAsC,SAAtC,EAAiD,EAAjD;AACA1F,aAAKiC,QAAL,CAAc,KAAK0D,gBAAnB,EAAqC,SAArC,EAAgD,EAAhD;;AAEAzF,cAAM,GAAN,EAAW,KAAKwF,iBAAhB,EAAmC1F,IAAnC,CAAwCmF,WAAWG,MAAnD,EACGM,IADH,CACQ,MADR,EACgB,KAAK5D,SAAL,CAAeU,SAAf,GAA2B,gBAD3C;AAED;AACD,WAAKgC,MAAL;AACD,KA9H+B;;AAgIhCmB,eAAW,qBAAW;AACpB,WAAKzE,SAAL,CAAeC,SAAf;;AAEA,WAAKyE,UAAL,CAAgB,KAAKxB,GAAL,CAASyB,MAAzB;;AAEA,UAAIvD,SAAS9B,YAAY+B,SAAZ,CAAsB,KAAKT,SAAL,CAAeU,SAArC,CAAb;AACAF,aAAOG,YAAP,GAAsBC,IAAtB,CAA2B9C,KAAK+C,KAAL,CAAW,IAAX,EAAiB,UAASC,QAAT,EAAmB;AAC7D,YAAIkD,OAAOlD,SAASkD,IAApB;AACA,YAAIC,YAAY,KAAK3B,GAAL,CAASC,QAAT,GAAoB,GAApB,GAA0ByB,IAA1C;AACA,aAAKF,UAAL,CAAgBG,SAAhB;AACD,OAJ0B,CAA3B,EAIInG,KAAK+C,KAAL,CAAW,IAAX,EAAiB,UAASM,GAAT,EAAc;AACjCC,gBAAQC,KAAR,CAAcF,GAAd;AACD,OAFG,CAJJ;AAOD,KA7I+B;;AA+IhC2C,gBAAY,oBAASG,SAAT,EAAoB;AAC9BjG,WAAKiC,QAAL,CAAc,KAAKuC,cAAnB,EAAmC,SAAnC,EAA8C,EAA9C;AACAxE,WAAKuF,OAAL,CAAa,KAAKf,cAAlB,EAAkC,WAAlC,EAA+CyB,SAA/C;AACAjG,WAAKiC,QAAL,CAAc,KAAKmD,gBAAnB,EAAqC,SAArC,EAAgD,MAAhD;AACApF,WAAKiC,QAAL,CAAc,KAAKoD,eAAnB,EAAoC,SAApC,EAA+C,MAA/C;;AAEA,WAAKD,gBAAL,CAAsBtB,SAAtB,GAAkC,EAAlC;;AAEA;AACA,UAAI,KAAK0B,aAAT,EAAwB;AACtBxF,aAAKiC,QAAL,CAAc,KAAKwD,eAAnB,EAAoC,SAApC,EAA+C,EAA/C;AACAzF,aAAKuF,OAAL,CAAa,KAAKE,eAAlB,EAAmC,WAAnC,EAAgDQ,SAAhD;AACAjG,aAAKiC,QAAL,CAAc,KAAKyD,iBAAnB,EAAsC,SAAtC,EAAiD,MAAjD;AACA1F,aAAKiC,QAAL,CAAc,KAAK0D,gBAAnB,EAAqC,SAArC,EAAgD,MAAhD;;AAEAzF,cAAM,GAAN,EAAW,KAAKwF,iBAAhB,EAAmC1F,IAAnC,CAAwC,EAAxC;AACD;;AAED,WAAK0E,MAAL;AACD,KAlK+B;;AAoKhCA,YAAQ,kBAAW;AACjB,UAAIwB,kBAAkBlG,KAAKmG,QAAL,CAAc,KAAKC,UAAnB,EAA+B,OAA/B,CAAtB;AACA,UAAIC,gBAAgBrG,KAAKmG,QAAL,CAAc,KAAKvC,QAAnB,EAA6B,OAA7B,CAApB;AACA,UAAI0C,kBAAkBtG,KAAKmG,QAAL,CAAc,KAAKI,UAAnB,EAA+B,OAA/B,CAAtB;AACA,UAAIC,iBAAiBxG,KAAKmG,QAAL,CAAc,KAAKxE,SAAnB,EAA8B,OAA9B,CAArB;AACA,UAAI8E,mBAAoBP,mBAAmBA,oBAAoB,MAAxC,IACpBG,iBAAiBA,kBAAkB,MADf,IAEpBC,mBAAmBA,oBAAoB,MAFnB,IAGpBE,kBAAkBA,mBAAmB,MAHxC;;AAKA,UAAIC,gBAAJ,EAAsB;AACpB,aAAKC,OAAL;AACD,OAFD,MAEO;AACLC,mBAAW7G,KAAK+C,KAAL,CAAW,IAAX,EAAiB,KAAK6B,MAAtB,CAAX,EAA0C,GAA1C;AACD;AACF,KAnL+B;;AAqLhCgC,aAAS,mBAAW;AAClB;AACA,WAAKE,uBAAL,CAA6B,CAAC,OAAD,EAAU,OAAV,EAAmB,UAAnB,CAA7B;AACD,KAxL+B;;AA0LhCC,aAAS,mBAAW;AAClB,UAAI,KAAKC,aAAT,EAAwB;AACtBC,qBAAa,KAAKD,aAAlB;AACA,aAAKA,aAAL,GAAqB,IAArB;AACD;AACD,WAAK1F,SAAL,CAAeC,SAAf;AACD,KAhM+B;;AAkMhC2F,wBAAoB,4BAAShF,SAAT,EAAoBiF,MAApB,EAA4BC,WAA5B,EAAyC;AAC3D,cAAQD,MAAR;AACE,aAAK,iBAAL;AACE,eAAKE,kBAAL,CAAwBnF,SAAxB,EAAmCkF,WAAnC;AACA;AACF;AACE;AALJ;AAOA,WAAKlF,SAAL,GAAiBA,SAAjB;AACA,WAAK0C,MAAL;AACD,KA5M+B;;AA8MhC0C,iBAAa,uBAAW;AACtB,WAAK1C,MAAL;AACD,KAhN+B;;AAkNhCM,gBAAY,oBAASF,IAAT,EAAe;AACzB,UAAI,KAAKuC,KAAT,EAAgB;AACd,aAAKpC,gBAAL;AACD;AACD,UAAI,CAACH,IAAL,EAAW;AACT;AACD;AACD,UAAIhD,WAAWvB,YAAY+G,YAAZ,CAAyBxC,IAAzB,CAAf;AACA,UAAIyC,UAAU;AACZzF,kBAAU,UADE;AAEZ0F,cAAO1F,SAAS2F,CAAV,GAAe,IAFT;AAGZC,aAAM5F,SAAS6F,CAAV,GAAe,IAHR;AAIZC,eAAQ9F,SAAS+F,CAAV,GAAe,IAJV;AAKZ5G,gBAASa,SAASgG,CAAV,GAAe;AALX,OAAd;AAOA,WAAKT,KAAL,GAAa/G,aAAayH,MAAb,CAAoB,KAApB,EAA2B;AACtC,iBAASR,OAD6B;AAEtC,iBAAS;AAF6B,OAA3B,EAGVzC,IAHU,EAGJ,QAHI,CAAb;AAID,KArO+B;;AAuOhCG,sBAAkB,4BAAW;AAC3B,UAAI,KAAKoC,KAAT,EAAgB;AACd/G,qBAAauG,OAAb,CAAqB,KAAKQ,KAA1B;AACA,aAAKA,KAAL,GAAa,IAAb;AACD;AACF,KA5O+B;;AA8OhCF,wBAAoB,4BAASnF,SAAT,EAAoBkF,WAApB,EAAiC;AACnD;AACA,UAAI,WAAWA,WAAX,IAA0BA,YAAY1F,KAAZ,KAAsB,KAAKQ,SAAL,CAAeR,KAAnE,EAA0E;AACxE,aAAKC,SAAL,CAAeqC,SAAf,GAA4BlD,MAAMmD,YAAN,CAAmBmD,YAAY1F,KAA/B,CAA5B;AACD;AACD,UAAI,cAAc0F,WAAd,IAA6BA,YAAYtF,QAAZ,KAAyB,KAAKI,SAAL,CAAeJ,QAAzE,EAAmF;AACjF,aAAKC,YAAL,CAAkBiC,SAAlB,GAA8BlD,MAAMmD,YAAN,CAAmBmD,YAAYtF,QAA/B,CAA9B;AACD;AACD,UAAI,UAAUsF,WAAV,IAAyBA,YAAY1D,IAAZ,KAAqB,KAAKxB,SAAL,CAAewB,IAAjE,EAAuE;AACrE,YAAG0D,YAAY1D,IAAf,EAAoB;AAClBxD,eAAKuF,OAAL,CAAa,KAAK9B,YAAlB,EAAgC,KAAhC,EAAuCyD,YAAY1D,IAAnD;AACAxD,eAAK2D,WAAL,CAAiB,KAAKC,QAAtB,EAAgC,QAAhC;AACD,SAHD,MAGK;AACH5D,eAAKgI,UAAL,CAAgB,KAAKvE,YAArB,EAAmC,KAAnC;AACAzD,eAAK6D,QAAL,CAAc,KAAKD,QAAnB,EAA6B,QAA7B;AACD;AACF;;AAED,UAAI,WAAWsD,WAAf,EAA4B;AAC1B,aAAKlD,mBAAL,CAAyBkD,YAAYxF,KAArC;AACD;;AAED,WAAKK,4BAAL,CAAkCC,SAAlC;AACD,KArQ+B;;AAuQhCD,kCAA8B,sCAASC,SAAT,EAAmB;AAC/C,UAAGA,UAAUiG,UAAb,EAAwB;AACtBjI,aAAKiC,QAAL,CAAc,KAAKR,SAAnB,EAA8B,OAA9B,EAAuCO,UAAUiG,UAAjD;AACD,OAFD,MAEK;AACHjI,aAAKiC,QAAL,CAAc,KAAKR,SAAnB,EAA8B,OAA9B,EAAuC,EAAvC;AACD;;AAEDb,YAAMsH,oBAAN,CAA2BlG,SAA3B,EAAsC,KAAKmG,QAA3C,EAAqD;AACnDC,cAAM,KAAKC,YADwC;AAEnD7E,cAAM,KAAKI,QAFwC;AAGnD0E,cAAM,KAAK7E;AAHwC,OAArD;AAKD,KAnR+B;;AAqRhCO,yBAAqB,6BAAStC,KAAT,EAAgB;AACnC1B,WAAKuI,KAAL,CAAW,KAAKC,gBAAhB;AACAzI,YAAM0I,OAAN,CAAc/G,KAAd,EAAqB,UAAS0G,IAAT,EAAe;AAClCpI,aAAK+H,MAAL,CAAY,GAAZ,EAAiB;AACfW,gBAAMN,KAAKO,GADI;AAEf,kBAAQ,MAFO;AAGf,sBAAY,KAAKR,QAHF;AAIfS,kBAAQ,QAJO;AAKfC,eAAK,qBALU;AAMf/E,qBAAW,WAAWlD,MAAMmD,YAAN,CAAmBqE,KAAKU,KAAxB,CAAX,GAA4C,sDAA5C,GAAqGC,OAAOC,OAAP,CAAeC,MAAf,CAAsBC,gBAA3H,GAA8I,QAN1I;AAOf,mBAAS;AAPM,SAAjB,EAQG,KAAKV,gBARR;AASD,OAVD,EAUG,IAVH;AAWD,KAlS+B;;AAoShC5B,6BAAyB,iCAASuC,WAAT,EAAsB;AAC7C;AACA,UAAI,KAAKC,eAAT,EAA0B;AACxB,aAAKA,eAAL,CAAqBC,MAArB;AACD;AACD,UAAI,KAAKC,iBAAT,EAA4B;AAC1B,aAAKA,iBAAL,CAAuBD,MAAvB;AACD;;AAED,UAAIF,YAAYI,OAAZ,CAAoB,OAApB,IAA+B,CAAnC,EAAsC;AACpC,aAAKH,eAAL,GAAuBjJ,GAAG,KAAKyD,QAAR,EAAkB,OAAlB,EAA2B9D,KAAK+C,KAAL,CAAW,IAAX,EAAiB,KAAK2G,YAAtB,CAA3B,CAAvB;AACA,aAAKF,iBAAL,GAAyBnJ,GAAG,KAAKkI,YAAR,EAAsB,SAAtB,EAAiCvI,KAAK+C,KAAL,CAAW,IAAX,EAAiB,KAAK4G,cAAtB,CAAjC,CAAzB;AACA;AACA;AACA;AACD,OAND,MAMO;AACLzJ,aAAKiC,QAAL,CAAc,KAAK2B,QAAnB,EAA6B;AAC3B8F,kBAAQ;AADmB,SAA7B;AAGD;AACF,KAxT+B;;AA0ThCC,mBAAe,yBAAW;AACxB,UAAIxE,aAAa1E,WAAWmJ,mBAAX,CAA+B,KAAK5H,SAAL,CAAeU,SAA9C,CAAjB;AACA,UAAIyC,UAAJ,EAAgB;AACd,aAAKD,QAAL,CAAcC,UAAd;AACD,OAFD,MAEO;AACL,aAAKU,SAAL;AACD;AACF,KAjU+B;;AAmUhC2D,kBAAc,wBAAW;AACvB;AACA,UAAI,KAAKhE,aAAT,EAAwB;AACtBxF,aAAK6G,OAAL,CAAa,KAAKrB,aAAlB;AACA;AACD;AACD,WAAKA,aAAL,GAAqB,KAAKqE,oBAAL,EAArB;;AAEA,UAAI,KAAKC,iBAAT,EAA4B;AAC1B,aAAKC,cAAL;AACD,OAFD,MAEO;AACL,aAAKC,cAAL;AACD;AACF,KAhV+B;;AAkVhCP,oBAAgB,wBAASQ,GAAT,EAAc;AAC5B,UAAGA,IAAIC,OAAJ,KAAgB9J,KAAK+J,KAAxB,EAA8B;AAC5B,aAAKX,YAAL;AACD;AACF,KAtV+B;;AAwVhCO,oBAAgB,0BAAW;AACzB/J,WAAKiC,QAAL,CAAc,KAAKuD,aAAnB,EAAkC,SAAlC,EAA6C,MAA7C;;AAEA,UAAIuD,OAAOqB,KAAX,EAAkB;AAChBpK,aAAKiC,QAAL,CAAcoI,WAAWC,QAAzB,EAAmC;AACjCC,iBAAO;AAD0B,SAAnC;AAGD,OAJD,MAIO;AACLvK,aAAKiC,QAAL,CAAcoI,WAAWC,QAAzB,EAAmC;AACjC9C,gBAAM;AAD2B,SAAnC;AAGD;;AAED,WAAKsC,iBAAL,GAAyB,KAAzB;AACD,KAtW+B;;AAwWhCE,oBAAgB,0BAAW;AACzBhK,WAAKiC,QAAL,CAAc,KAAKuD,aAAnB,EAAkC,SAAlC,EAA6C,EAA7C;;AAEA,UAAIuD,OAAOqB,KAAX,EAAkB;AAChBpK,aAAKiC,QAAL,CAAcoI,WAAWC,QAAzB,EAAmC;AACjCC,iBAAOvK,KAAKwK,aAAL,CAAmB,KAAKhF,aAAxB,EAAuCqC,CAAvC,GAA2C;AADjB,SAAnC;AAGD,OAJD,MAIO;AACL7H,aAAKiC,QAAL,CAAcoI,WAAWC,QAAzB,EAAmC;AACjC9C,gBAAMxH,KAAKwK,aAAL,CAAmB,KAAKhF,aAAxB,EAAuCqC,CAAvC,GAA2C;AADhB,SAAnC;AAGD;;AAED,WAAKiC,iBAAL,GAAyB,IAAzB;AACD,KAtX+B;;AAwXhCD,0BAAsB,gCAAW;AAC/B,UAAI/E,IAAJ,EAAUrD,SAAV,EAAqBgJ,GAArB;AACAA,YAAMzK,KAAKwK,aAAL,CAAmBH,WAAWK,UAA9B,CAAN;;AAEA5F,aAAO9E,KAAK+H,MAAL,CAAY,KAAZ,EAAmB;AACxB,iBAAS,kCADe;AAExB4C,eAAO;AACL7I,oBAAU,UADL;AAEL8I,kBAAQ,GAFH;AAGLlD,eAAK,CAHA;AAILmD,kBAAQ;AAJH;AAFiB,OAAnB,EAQJR,WAAWK,UARP,CAAP;;AAUA,UAAI3B,OAAOqB,KAAX,EAAkB;AAChBpK,aAAKiC,QAAL,CAAc6C,IAAd,EAAoB;AAClByF,iBAAO,CADW;AAElB/C,gBAAM;AAFY,SAApB;AAID,OALD,MAKO;AACLxH,aAAKiC,QAAL,CAAc6C,IAAd,EAAoB;AAClB0C,gBAAM,CADY;AAElB+C,iBAAO;AAFW,SAApB;AAID;;AAED9I,kBAAYzB,KAAK+H,MAAL,CAAY,KAAZ,EAAmB;AAC7B,iBAAS,aADoB;AAE7B4C,eAAO;AACL1J,kBAAQ,KAAKA,MAAL,GAAc,IADjB;AAEL2G,iBAAO;AAFF;AAFsB,OAAnB,EAMT9C,IANS,CAAZ;;AAQA,UAAIlB,WAAW5D,KAAK+H,MAAL,CAAY,KAAZ,EAAmB;AAChC,iBAAS,8CADuB;AAEhCrE,aAAK,KAAK1B,SAAL,CAAewB,IAAf,GAAsB,KAAKxB,SAAL,CAAewB,IAArC,GAA4C,KAAKsH,SAAL,GAAiB,qBAFlC;AAGhCH,eAAO;AACL/C,iBAAO,MADF;AAEL3G,kBAAQ,MAFH;AAGL8J,qBAAY,CAAC,KAAK9J,MAAL,GAAc,EAAf,IAAqB,CAAtB,GAA2B;AAHjC;AAHyB,OAAnB,EAQZQ,SARY,CAAf;;AAUA,UAAIuJ,WAAWhL,KAAK+H,MAAL,CAAY,KAAZ,EAAmB;AAChC,iBAAS,6DADuB;AAEhCjE,mBAAWlD,MAAMmD,YAAN,CAAmB,KAAK/B,SAAL,CAAeR,KAAlC,CAFqB;AAGhCmJ,eAAO;AACLM,sBAAY,KAAKhK,MAAL,GAAc;AADrB;AAHyB,OAAnB,EAMZQ,SANY,CAAf;;AAQA,UAAIyJ,aAAa,MAAjB;AACA,UAAG;AACDA,qBAAalL,KAAKsH,YAAL,CAAkB7F,SAAlB,EAA6BoG,CAA7B,GACX7H,KAAKsH,YAAL,CAAkB1D,QAAlB,EAA4BiE,CADjB,GAEX7H,KAAKmL,gBAAL,CAAsBH,QAAtB,EAAgCnD,CAFrB,GAEyB,IAFtC;AAGD,OAJD,CAIE,OAAM1E,GAAN,EAAW;AACXC,gBAAQC,KAAR,CAAcF,GAAd;AACA+H,qBAAa,MAAb;AACD;AACDlL,WAAKiC,QAAL,CAAc+I,QAAd,EAAwB,OAAxB,EAAiCE,UAAjC;;AAEAnL,YAAM0I,OAAN,CAAc,KAAKzG,SAAL,CAAeN,KAA7B,EAAoC,UAAS0G,IAAT,EAAe;AACjD,aAAKgD,eAAL,CAAqBtG,IAArB,EAA2BsD,IAA3B,EAAiC,KAAjC;AACD,OAFD,EAEG,IAFH;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,WAAKgD,eAAL,CAAqBtG,IAArB,EAA2B;AACzBgE,eAAO,EADkB;AAEzBH,aAAK;AAFoB,OAA3B,EAGG,KAHH;AAIA,aAAO7D,IAAP;AACD,KAjd+B;;AAmdhCsG,qBAAiB,yBAASC,aAAT,EAAwBjD,IAAxB,EAA8BkD,MAA9B,EAAsC;AACrD,UAAIxG,IAAJ,EAAUyG,QAAV,EAAoBC,eAApB,EAAqCC,SAArC;;AAEA3G,aAAO9E,KAAK0L,KAAL,CAAW,+BAAX,EAA4CL,aAA5C,CAAP;;AAEAE,iBAAWvL,KAAK0L,KAAL,CAAW,0BAAX,EAAuC5G,IAAvC,CAAX;AACA,UAAIwG,MAAJ,EAAY;AACVG,oBAAY,qBAAZ;AACD,OAFD,MAEO;AACLA,oBAAY,cAAZ;AACD;AACDD,wBAAkBxL,KAAK0L,KAAL,CAAW,iBAAiBD,SAAjB,GAA6B,UAAxC,EAAoD3G,IAApD,CAAlB;AACA9E,WAAK+H,MAAL,CAAY,GAAZ,EAAiB;AACfW,cAAMN,KAAKO,GADI;AAEf,iBAAS,eAFM;AAGfC,gBAAQ,QAHO;AAIfC,aAAK,qBAJU;AAKf/E,mBAAWlD,MAAMmD,YAAN,CAAmBqE,KAAKU,KAAxB,CALI;AAMftH,eAAO4G,KAAKU,KANG;AAOf6B,eAAO;AACLM,sBAAY;AADP;AAPQ,OAAjB,EAUGO,eAVH;;AAYA,aAAO1G,IAAP;AACD,KA5e+B;;AA8ehC6G,oBAAgB,0BAAW;AACzBlL,iBAAWmL,YAAX,CAAwB,KAAK5J,SAAL,CAAeU,SAAvC,EAAkD,KAAKV,SAAL,CAAe6J,KAAjE;AACD,KAhf+B;;AAkfhCC,qBAAiB,2BAAW;AAC1B,UAAIC,gBAAgB,CAAC,KAAK/J,SAAL,CAAeI,IAApC;;AAEA,UAAI2J,aAAJ,EAAmB;AACjB;AACAtL,mBAAWuL,UAAX;AACD,OAHD,MAGO;AACL,YAAInL,OAAJ,CAAY;AACVoL,mBAAS,KAAK3H,GAAL,CAAS4H;AADR,SAAZ;AAGD;AACF,KA7f+B;;AA+fhCC,sBAAkB,4BAAU,CAE3B;AAjgB+B,GAAtB,CAAZ;AAmgBA,SAAOrL,KAAP;AACD,CA5hBH","file":"Widget.js","sourcesContent":["///////////////////////////////////////////////////////////////////////////\r\n// Copyright Â© Esri. All Rights Reserved.\r\n//\r\n// Licensed under the Apache License Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//    http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n///////////////////////////////////////////////////////////////////////////\r\n\r\ndefine([\r\n    'dojo/_base/declare',\r\n    'dojo/_base/lang',\r\n    'dojo/_base/array',\r\n    'dojo/_base/html',\r\n    'dojo/_base/Color',\r\n    'dojo/query',\r\n    'dojo/on',\r\n    'dojo/keys',\r\n    'dojo/mouse',\r\n    'dojo/dom-construct',\r\n    'dojo/dom-geometry',\r\n    'jimu/BaseWidget',\r\n    'jimu/tokenUtils',\r\n    'jimu/portalUtils',\r\n    'jimu/portalUrlUtils',\r\n    'jimu/utils',\r\n    'jimu/dijit/Message'\r\n  ],\r\n  function(declare, lang, array, html, Color, query, on, keys, mouse,\r\n    domConstruct, domGeometry, BaseWidget, tokenUtils, portalUtils,\r\n    portalUrlUtils, utils, Message) {\r\n    /* global jimuConfig */\r\n    /* jshint scripturl:true */\r\n    var clazz = declare([BaseWidget], {\r\n\r\n      baseClass: 'jimu-widget-dnd-header',\r\n\r\n      //title, links are switchable depends the browser width\r\n      switchableElements: {},\r\n\r\n      //the default height of the widget\r\n      height: 80,\r\n\r\n      moveTopOnActive: false,\r\n\r\n      postMixInProperties: function() {\r\n        this.inherited(arguments);\r\n        this.isRenderIdForAttrs = true;\r\n      },\r\n\r\n      postCreate: function() {\r\n        this.inherited(arguments);\r\n\r\n        this.switchableElements.title = this.titleNode;\r\n        this.switchableElements.links = this.linksNode;\r\n        this.switchableElements.subtitle = this.subtitleNode;\r\n\r\n        if (this.position && this.position.height) {\r\n          this.height = this.position.height;\r\n        }\r\n\r\n        this._handleTitleColorAndLogoLink(this.appConfig);\r\n\r\n        // if (!this.appConfig.portalUrl) {\r\n        html.setStyle(this.signInSectionNode, 'display', 'none');\r\n        // } else {\r\n        //   html.setStyle(this.signInSectionNode, 'display', '');\r\n        // }\r\n        if (this.config && this.config.mode === 'custom' && this.config.color) {\r\n          var color = new Color(this.config.color);\r\n          html.setStyle(this.domNode, 'background', color.toHex());\r\n        } else if (this.config && this.config.mode === 'org') {\r\n          // read org shared color\r\n          var portal = portalUtils.getPortal(this.appConfig.portalUrl);\r\n          portal.loadSelfInfo().then(lang.hitch(this, function (selfInfo) {\r\n            if (selfInfo && selfInfo.portalProperties && selfInfo.portalProperties.sharedTheme &&\r\n              selfInfo.portalProperties.sharedTheme.header) {\r\n              html.setStyle(this.domNode, 'background', selfInfo.portalProperties.sharedTheme.header.background);\r\n            }\r\n          }), lang.hitch(this, function (err) {\r\n            console.error(err);\r\n          }));\r\n        } else if (this.config && this.config.mode === 'theme') {\r\n          // use theme color\r\n          html.setStyle(this.domNode, 'background', null);\r\n        } else {\r\n          // no config or mode is 'theme'\r\n          var mainBackgroundColor = lang.getObject('theme.customStyles.mainBackgroundColor', false, this.appConfig);\r\n          if (mainBackgroundColor) {\r\n            html.setStyle(this.domNode, 'background', mainBackgroundColor);\r\n          }\r\n        }\r\n\r\n        if (this.appConfig && this.appConfig.logo) {\r\n          this.logoIconNode.src = this.appConfig.logo;\r\n          html.removeClass(this.logoNode, 'hidden');\r\n        } else {\r\n          this.logoIconNode.src = \"\";\r\n          html.addClass(this.logoNode, 'hidden');\r\n        }\r\n\r\n        this.switchableElements.title.innerHTML =\r\n          utils.sanitizeHTML(this.appConfig.title ? this.appConfig.title : '');\r\n        this.switchableElements.subtitle.innerHTML =\r\n          utils.sanitizeHTML(this.appConfig.subtitle ? this.appConfig.subtitle : '');\r\n\r\n        this._createDynamicLinks(this.appConfig.links);\r\n\r\n        this.own(on(this.domNode, mouse.enter, lang.hitch(this, function() {\r\n          var title = '';\r\n          var portalUrl = this.appConfig && this.appConfig.portalUrl || '';\r\n          var server = portalUrlUtils.getServerByUrl(portalUrl);\r\n          if (portalUrlUtils.isArcGIScom(server)) {\r\n            server = 'ArcGIS.com';\r\n          }\r\n          if (server) {\r\n            title = this.nls.signInTo + ' ' + server;\r\n          }\r\n          this.signinLinkNode.title = title;\r\n        })));\r\n      },\r\n\r\n      startup: function() {\r\n        this.inherited(arguments);\r\n        this.resize();\r\n        // this.timeoutHandle = setTimeout(lang.hitch(this, this.resize), 100);\r\n      },\r\n\r\n      onAction: function(action, data) {\r\n        /*jshint unused: false*/\r\n        if (action === 'highLight' && data) {\r\n          var node = query('div[settingid=\"' + data.widgetId + '\"]', this.domNode)[0];\r\n          this._highLight(node);\r\n        }\r\n        if (action === 'removeHighLight') {\r\n          this._removeHighLight();\r\n        }\r\n      },\r\n\r\n      onSignIn: function(credential) {\r\n        this.inherited(arguments);\r\n\r\n        html.setStyle(this.signinLinkNode, 'display', 'none');\r\n        html.setStyle(this.userNameLinkNode, 'display', '');\r\n        html.setStyle(this.signoutLinkNode, 'display', '');\r\n\r\n        this.userNameLinkNode.innerHTML = credential.userId;\r\n        html.setAttr(this.userNameLinkNode, 'href', this.appConfig.portalUrl + 'home/user.html');\r\n\r\n        //popup\r\n        if (this.popupLinkNode) {\r\n          html.setStyle(this.popupSigninNode, 'display', 'none');\r\n          html.setStyle(this.popupUserNameNode, 'display', '');\r\n          html.setStyle(this.popupSignoutNode, 'display', '');\r\n\r\n          query('a', this.popupUserNameNode).html(credential.userId)\r\n            .attr('href', this.appConfig.portalUrl + 'home/user.html');\r\n        }\r\n        this.resize();\r\n      },\r\n\r\n      onSignOut: function() {\r\n        this.inherited(arguments);\r\n\r\n        this._onSignOut(this.nls.signin);\r\n\r\n        var portal = portalUtils.getPortal(this.appConfig.portalUrl);\r\n        portal.loadSelfInfo().then(lang.hitch(this, function(selfInfo) {\r\n          var name = selfInfo.name;\r\n          var signInTip = this.nls.signInTo + ' ' + name;\r\n          this._onSignOut(signInTip);\r\n        }), lang.hitch(this, function(err) {\r\n          console.error(err);\r\n        }));\r\n      },\r\n\r\n      _onSignOut: function(signInTip) {\r\n        html.setStyle(this.signinLinkNode, 'display', '');\r\n        html.setAttr(this.signinLinkNode, 'innerHTML', signInTip);\r\n        html.setStyle(this.userNameLinkNode, 'display', 'none');\r\n        html.setStyle(this.signoutLinkNode, 'display', 'none');\r\n\r\n        this.userNameLinkNode.innerHTML = '';\r\n\r\n        //popup\r\n        if (this.popupLinkNode) {\r\n          html.setStyle(this.popupSigninNode, 'display', '');\r\n          html.setAttr(this.popupSigninNode, 'innerHTML', signInTip);\r\n          html.setStyle(this.popupUserNameNode, 'display', 'none');\r\n          html.setStyle(this.popupSignoutNode, 'display', 'none');\r\n\r\n          query('a', this.popupUserNameNode).html('');\r\n        }\r\n\r\n        this.resize();\r\n      },\r\n\r\n      resize: function() {\r\n        var headerNodeFloat = html.getStyle(this.headerNode, 'float');\r\n        var logoNodeFloat = html.getStyle(this.logoNode, 'float');\r\n        var titlesNodeFloat = html.getStyle(this.titlesNode, 'float');\r\n        var linksNodeFloat = html.getStyle(this.linksNode, 'float');\r\n        var allHasFloatStyle = (headerNodeFloat && headerNodeFloat !== 'none') &&\r\n          (logoNodeFloat && logoNodeFloat !== 'none') &&\r\n          (titlesNodeFloat && titlesNodeFloat !== 'none') &&\r\n          (linksNodeFloat && linksNodeFloat !== 'none');\r\n\r\n        if (allHasFloatStyle) {\r\n          this._resize();\r\n        } else {\r\n          setTimeout(lang.hitch(this, this.resize), 200);\r\n        }\r\n      },\r\n\r\n      _resize: function() {\r\n        //by default, we show all elements\r\n        this._showSwitchableElements(['title', 'links', 'subtitle']);\r\n      },\r\n\r\n      destroy: function() {\r\n        if (this.timeoutHandle) {\r\n          clearTimeout(this.timeoutHandle);\r\n          this.timeoutHandle = null;\r\n        }\r\n        this.inherited(arguments);\r\n      },\r\n\r\n      onAppConfigChanged: function(appConfig, reason, changedData) {\r\n        switch (reason) {\r\n          case 'attributeChange':\r\n            this._onAttributeChange(appConfig, changedData);\r\n            break;\r\n          default:\r\n            return;\r\n        }\r\n        this.appConfig = appConfig;\r\n        this.resize();\r\n      },\r\n\r\n      _onLogoLoad: function() {\r\n        this.resize();\r\n      },\r\n\r\n      _highLight: function(node) {\r\n        if (this.hlDiv) {\r\n          this._removeHighLight();\r\n        }\r\n        if (!node) {\r\n          return;\r\n        }\r\n        var position = domGeometry.getMarginBox(node);\r\n        var hlStyle = {\r\n          position: 'absolute',\r\n          left: (position.l) + 'px',\r\n          top: (position.t) + 'px',\r\n          width: (position.w) + 'px',\r\n          height: (position.h) + 'px'\r\n        };\r\n        this.hlDiv = domConstruct.create('div', {\r\n          \"style\": hlStyle,\r\n          \"class\": 'icon-highlight'\r\n        }, node, 'before');\r\n      },\r\n\r\n      _removeHighLight: function() {\r\n        if (this.hlDiv) {\r\n          domConstruct.destroy(this.hlDiv);\r\n          this.hlDiv = null;\r\n        }\r\n      },\r\n\r\n      _onAttributeChange: function(appConfig, changedData) {\r\n        /*jshint unused: false*/\r\n        if ('title' in changedData && changedData.title !== this.appConfig.title) {\r\n          this.titleNode.innerHTML =  utils.sanitizeHTML(changedData.title);\r\n        }\r\n        if ('subtitle' in changedData && changedData.subtitle !== this.appConfig.subtitle) {\r\n          this.subtitleNode.innerHTML = utils.sanitizeHTML(changedData.subtitle);\r\n        }\r\n        if ('logo' in changedData && changedData.logo !== this.appConfig.logo) {\r\n          if(changedData.logo){\r\n            html.setAttr(this.logoIconNode, 'src', changedData.logo);\r\n            html.removeClass(this.logoNode, 'hidden');\r\n          }else{\r\n            html.removeAttr(this.logoIconNode, 'src');\r\n            html.addClass(this.logoNode, 'hidden');\r\n          }\r\n        }\r\n\r\n        if ('links' in changedData) {\r\n          this._createDynamicLinks(changedData.links);\r\n        }\r\n\r\n        this._handleTitleColorAndLogoLink(appConfig);\r\n      },\r\n\r\n      _handleTitleColorAndLogoLink: function(appConfig){\r\n        if(appConfig.titleColor){\r\n          html.setStyle(this.titleNode, 'color', appConfig.titleColor);\r\n        }else{\r\n          html.setStyle(this.titleNode, 'color', '');\r\n        }\r\n\r\n        utils.themesHeaderLogoA11y(appConfig, this.tabIndex, {\r\n          link: this.logoLinkNode,\r\n          logo: this.logoNode,\r\n          icon: this.logoIconNode\r\n        });\r\n      },\r\n\r\n      _createDynamicLinks: function(links) {\r\n        html.empty(this.dynamicLinksNode);\r\n        array.forEach(links, function(link) {\r\n          html.create('a', {\r\n            href: link.url,\r\n            'role': 'link',\r\n            'tabindex': this.tabIndex,\r\n            target: '_blank',\r\n            rel: 'noopener noreferrer',\r\n            innerHTML: '<span>' + utils.sanitizeHTML(link.label) + '</span><div class=\"screen-readers-only-no-position\">' + window.jimuNls.common.opensInNewWindow + '</div>',\r\n            'class': \"jimu-link jimu-align-leading jimu-leading-margin1\"\r\n          }, this.dynamicLinksNode);\r\n        }, this);\r\n      },\r\n\r\n      _showSwitchableElements: function(showElement) {\r\n        //links is hidden\r\n        if (this.logoClickHandle) {\r\n          this.logoClickHandle.remove();\r\n        }\r\n        if (this.logoKeydownHandle) {\r\n          this.logoKeydownHandle.remove();\r\n        }\r\n\r\n        if (showElement.indexOf('links') < 0) {\r\n          this.logoClickHandle = on(this.logoNode, 'click', lang.hitch(this, this._onLogoClick));\r\n          this.logoKeydownHandle = on(this.logoLinkNode, 'keydown', lang.hitch(this, this._onLogoKeydown));\r\n          // html.setStyle(this.logoNode, {\r\n          //   cursor: 'pointer'\r\n          // });\r\n        } else {\r\n          html.setStyle(this.logoNode, {\r\n            cursor: 'default'\r\n          });\r\n        }\r\n      },\r\n\r\n      _switchSignin: function() {\r\n        var credential = tokenUtils.getPortalCredential(this.appConfig.portalUrl);\r\n        if (credential) {\r\n          this.onSignIn(credential);\r\n        } else {\r\n          this.onSignOut();\r\n        }\r\n      },\r\n\r\n      _onLogoClick: function() {\r\n        // return;\r\n        if (this.popupLinkNode) {\r\n          html.destroy(this.popupLinkNode);\r\n          // this._switchSignin();\r\n        }\r\n        this.popupLinkNode = this._createPopupLinkNode();\r\n\r\n        if (this.popupLinksVisible) {\r\n          this._hidePopupLink();\r\n        } else {\r\n          this._showPopupLink();\r\n        }\r\n      },\r\n\r\n      _onLogoKeydown: function(evt) {\r\n        if(evt.keyCode === keys.ENTER){\r\n          this._onLogoClick();\r\n        }\r\n      },\r\n\r\n      _hidePopupLink: function() {\r\n        html.setStyle(this.popupLinkNode, 'display', 'none');\r\n\r\n        if (window.isRTL) {\r\n          html.setStyle(jimuConfig.layoutId, {\r\n            right: 0\r\n          });\r\n        } else {\r\n          html.setStyle(jimuConfig.layoutId, {\r\n            left: 0\r\n          });\r\n        }\r\n\r\n        this.popupLinksVisible = false;\r\n      },\r\n\r\n      _showPopupLink: function() {\r\n        html.setStyle(this.popupLinkNode, 'display', '');\r\n\r\n        if (window.isRTL) {\r\n          html.setStyle(jimuConfig.layoutId, {\r\n            right: html.getContentBox(this.popupLinkNode).w + 'px'\r\n          });\r\n        } else {\r\n          html.setStyle(jimuConfig.layoutId, {\r\n            left: html.getContentBox(this.popupLinkNode).w + 'px'\r\n          });\r\n        }\r\n\r\n        this.popupLinksVisible = true;\r\n      },\r\n\r\n      _createPopupLinkNode: function() {\r\n        var node, titleNode, box;\r\n        box = html.getContentBox(jimuConfig.mainPageId);\r\n\r\n        node = html.create('div', {\r\n          'class': 'popup-links jimu-main-background',\r\n          style: {\r\n            position: 'absolute',\r\n            zIndex: 100,\r\n            top: 0,\r\n            bottom: 0\r\n          }\r\n        }, jimuConfig.mainPageId);\r\n\r\n        if (window.isRTL) {\r\n          html.setStyle(node, {\r\n            right: 0,\r\n            left: '50px'\r\n          });\r\n        } else {\r\n          html.setStyle(node, {\r\n            left: 0,\r\n            right: '50px'\r\n          });\r\n        }\r\n\r\n        titleNode = html.create('div', {\r\n          'class': 'popup-title',\r\n          style: {\r\n            height: this.height + 'px',\r\n            width: '100%'\r\n          }\r\n        }, node);\r\n\r\n        var logoNode = html.create('img', {\r\n          'class': 'logo jimu-float-leading jimu-leading-margin1',\r\n          src: this.appConfig.logo ? this.appConfig.logo : this.folderUrl + 'images/app-logo.png',\r\n          style: {\r\n            width: '30px',\r\n            height: '30px',\r\n            marginTop: ((this.height - 30) / 2) + 'px'\r\n          }\r\n        }, titleNode);\r\n\r\n        var textNode = html.create('div', {\r\n          'class': 'title jimu-float-leading jimu-leading-margin1 jimu-ellipsis',\r\n          innerHTML: utils.sanitizeHTML(this.appConfig.title),\r\n          style: {\r\n            lineHeight: this.height + 'px'\r\n          }\r\n        }, titleNode);\r\n\r\n        var titleWidth = 'auto';\r\n        try{\r\n          titleWidth = html.getMarginBox(titleNode).w -\r\n            html.getMarginBox(logoNode).w -\r\n            html.getMarginExtents(textNode).w + 'px';\r\n        } catch(err) {\r\n          console.error(err);\r\n          titleWidth = 'auto';\r\n        }\r\n        html.setStyle(textNode, 'width', titleWidth);\r\n\r\n        array.forEach(this.appConfig.links, function(link) {\r\n          this._createLinkNode(node, link, false);\r\n        }, this);\r\n\r\n        // this.popupSigninNode = this._createLinkNode(node, {\r\n        //   label: 'SignIn',\r\n        //   url: '#'\r\n        // }, true);\r\n        // this.popupUserNameNode = this._createLinkNode(node, {\r\n        //   label: '',\r\n        //   url: '#'\r\n        // }, true);\r\n        // this.popupSignoutNode = this._createLinkNode(node, {\r\n        //   label: 'SignOut',\r\n        //   url: '#'\r\n        // }, true);\r\n\r\n        // this.own(on(this.popupSigninNode, 'click', lang.hitch(this, '_onSigninClick')));\r\n        // this.own(on(this.popupSignoutNode, 'click', lang.hitch(this, '_onSignoutClick')));\r\n\r\n        //empty\r\n        this._createLinkNode(node, {\r\n          label: '',\r\n          url: '#'\r\n        }, false);\r\n        return node;\r\n      },\r\n\r\n      _createLinkNode: function(containerNode, link, isSign) {\r\n        var node, lineNode, linkSectionNode, className;\r\n\r\n        node = html.place('<div class=\"jimu-link\"></div>', containerNode);\r\n\r\n        lineNode = html.place('<div class=\"line\"></div>', node);\r\n        if (isSign) {\r\n          className = 'link-section signin';\r\n        } else {\r\n          className = 'link-section';\r\n        }\r\n        linkSectionNode = html.place('<div class=\"' + className + '\"></div>', node);\r\n        html.create('a', {\r\n          href: link.url,\r\n          'class': 'jimu-ellipsis',\r\n          target: '_blank',\r\n          rel: \"noopener noreferrer\",\r\n          innerHTML: utils.sanitizeHTML(link.label),\r\n          title: link.label,\r\n          style: {\r\n            lineHeight: '66px'\r\n          }\r\n        }, linkSectionNode);\r\n\r\n        return node;\r\n      },\r\n\r\n      _onSigninClick: function() {\r\n        tokenUtils.signInPortal(this.appConfig.portalUrl, this.appConfig.appId);\r\n      },\r\n\r\n      _onSignoutClick: function() {\r\n        var isDepolyedApp = !this.appConfig.mode;\r\n\r\n        if (isDepolyedApp) {\r\n          //tokenUtils.signOutPortal(this.appConfig.portalUrl);\r\n          tokenUtils.signOutAll();\r\n        } else {\r\n          new Message({\r\n            message: this.nls.cantSignOutTip\r\n          });\r\n        }\r\n      },\r\n\r\n      _onUserNameClick: function(){\r\n\r\n      }\r\n    });\r\n    return clazz;\r\n  });"]}